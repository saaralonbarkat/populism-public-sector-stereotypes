---
title: "cses_02"
subtitle: "version 02"
date: today
author: "Lior Shvarts"
format:
  html: 
    self-contained: true
    page-layout: full
    code-fold: true
    toc: true
    toc-location: left
execute:
  message: false
  warning: false
---

* **Loading Packages**

```{r}
library(tidyverse)
library(gt)
library(gtsummary)
library(janitor)
library(sjPlot)
library(ggcorrplot)
library(labelled)
library(haven)
library(readxl)
library(broom)
library(lme4)
library(ggpubr)
library(ggeffects)
library(lavaan)
Sys.setlocale("LC_ALL","Herbrew")
```

* **Data**

```{r}
cses_raw <- read_sav("data/cses5.sav")
```

```{r}
cses_isr <- cses_raw %>%
  janitor::clean_names() %>%
  filter(e1006_nam == "Israel") %>%
  mutate(understands_politics = recode(e3003, #q03
                                          `7` = 99,
                                          `8` = 99,
                                          `9` = 99),
         understands_politics = na_if(understands_politics, 99),
         compromise_betrayal = recode(e3004_1, # q04a
                                      `7` = 99,
                                      `8` = 99,
                                      `9` = 99),
         compromise_betrayal = na_if(compromise_betrayal, 99),
         dont_care_ppl = recode(e3004_2, # q04b
                                `7` = 99,
                                `8` = 99,
                                `9` = 99),
         dont_care_ppl = na_if(dont_care_ppl, 99),
         trustworthy = recode(e3004_3, # q04c
                              `7` = 99,
                              `8` = 99,
                              `9` = 99),
         trustworthy = na_if(trustworthy, 99),
         main_problem = recode(e3004_4, # q04d
                               `7` = 99,
                               `8` = 99,
                               `9` = 99),
         main_problem = na_if(main_problem, 99),
         strong_leader = recode(e3004_5, # q05e
                                `7` = 99,
                                `8` = 99,
                                `9` = 99),
         strong_leader = na_if(strong_leader, 99),
         decision_by_ppl = recode(e3004_6, # q04f
                                  `7` = 99,
                                  `8` = 99,
                                  `9` = 99),
         decision_by_ppl = na_if(decision_by_ppl, 99),
         care_tycoons = recode(e3004_7, # q04g
                               `7` = 99,
                               `8` = 99,
                               `9` = 99),
         care_tycoons = na_if(care_tycoons, 99),
         gender = recode(e2002, # e2002
                         `1` = 0, # male
                         `2` = 1, # female
                         .default = 99),
         gender = na_if(gender, 99),
         age = recode(e2001_a, # d02
                      `9999` = 99),
         age = na_if(age, 99),
         education = recode(e2003, # d03
                            `1` = 1, # no bagrut
                            `2` = 1, # no bagrut
                            `3` = 1, # no bagrut
                            `4` = 2, # bagrut
                            `5` = 3, # post high school
                            `6` = 3, # post high school
                            `7` = 4, # B.A.
                            `8` = 5, # M.A.
                            `9` = 6, # Ph.D
                            `96` = 1, # no bagrut
                            .default = 99),
         education = na_if(education, 99),
         household_income = recode(e2011, # d09
                                   `99999997` = 99,
                                   `99999998` = 99,
                                   `99999999` = 99), 
         household_income = na_if(household_income, 99),
         religion = recode(e2013, # d10
                           `1101` = "Christian",
                           `1200` = "Christian",
                           `2000` = "Jewish",
                           `3000` = "Muslim",
                           `3211` = "Druze",
                           .default = "unknown"),
         religion = na_if(religion, "unknown"),
         pop_group = recode(e2016, # a8
                            `1` = 1, # jewish
                            `2` = 0), # arab
         pop_group = na_if(pop_group, 99),
         left_right_scale = recode(e3020, # q18
                                   `95` = 99,
                                   `97` = 99,
                                   `98` = 99),
         left_right_scale = na_if(left_right_scale, 99)) %>%
  filter(pop_group == 1) # jewish
```

# **The Wording of the Questions (in Hebrew)**

* **Q03 / e3003 / understands_politics**

אתה מרגיש שאתה מבין את הנושאים הפוליטיים החשובים ביותר של המדינה

* **Q04a / e3004_1 / compromise_betrayal**

מה שאנשים מכנים "פשרה" בפוליטיקה זה בעצם בגידה בעקרונות

* **Q04b / e3004_2 / dont_care_ppl**

לרוב הפוליטיקאים לא אכפת מהעם

* **Q04c / e3004_3 / trustworthy**

אפשר לתת אמון ברוב הפוליטיקאים

* **Q04d / e3004_4 / main_problem**

פוליטיקאים הם הבעיה העיקרית של ישראל

* **Q04e / e3004_5 / strong_leader**

מנהיג חזק הוא טוב לישראל, גם אם אותו מנהיג מכופף את הכללים על מנת להשיג תוצאות

* **Q04f / e3004_6 / decision_by_ppl**

העם הוא זה שצריך לקבל את ההחלטות המדיניות החשובות ביותר שלנו ולא הפוליטיקאים

* **Q04g / e3004_7 / care_tycoons**

לרוב הפוליטיקאים אכפת רק מהאינטרסים של בעלי ההון והעוצמה במדינה

# **Descriptive Statistics**

```{r}
cses_isr %>%
  mutate(household_income = as.factor(household_income)) %>%
  dplyr::select(understands_politics, compromise_betrayal, dont_care_ppl, trustworthy, main_problem, strong_leader, decision_by_ppl, care_tycoons, gender, age, education, household_income, religion, pop_group, left_right_scale) %>%
  gtsummary::tbl_summary(statistic = list(c(age, left_right_scale) ~ "{mean} ({sd})")) %>%
  bold_labels()
```

# **Correlation table**

```{r}
cses_isr %>%
  dplyr::select(understands_politics, compromise_betrayal, dont_care_ppl, trustworthy, main_problem, strong_leader, decision_by_ppl, care_tycoons, gender, age, education, household_income, left_right_scale) %>%
  sjPlot::tab_corr(triangle = "lower",
                   corr.method = "pearson",
                   p.numeric = T,
                   na.deletion = "listwise")
```

# **Cronbach's Alpha**

## **All variables**

```{r}
cses_isr %>%
  dplyr::select(understands_politics, compromise_betrayal, dont_care_ppl, trustworthy, main_problem, strong_leader, decision_by_ppl, care_tycoons) %>%
  sjPlot::tab_itemscale()
```

## **Anti-Elitism**

```{r}
cses_isr %>%
  dplyr::select(dont_care_ppl, trustworthy, main_problem, care_tycoons) %>%
  sjPlot::tab_itemscale()
```

# **CFA**

## **All variables**

```{r}
cfa_m <- '
one_factor = ~ understands_politics + compromise_betrayal + dont_care_ppl + trustworthy + main_problem + strong_leader + decision_by_ppl + care_tycoons '

fit_cfa_m <- lavaan::cfa(cfa_m,
                         data = cses_isr,
                         se = "robust",
                         std.lv = T)

summary(fit_cfa_m, fit.measures = T, standardize = T)
```

## **Anti-Elitism**

```{r}
cfa_m <- '
anti_elitism = ~ dont_care_ppl + trustworthy + main_problem + care_tycoons '

fit_cfa_m <- lavaan::cfa(cfa_m,
                         data = cses_isr,
                         se = "robust",
                         std.lv = T)

summary(fit_cfa_m, fit.measures = T, standardize = T)
```


```{r}
cses_isr <- cses_isr %>%
  mutate(anti_elitism = (((dont_care_ppl + trustworthy + main_problem + care_tycoons) / 4-1) / 4))
```

## **Regression Tables**

```{r}
# anti_elitism
m_1 <- lm(anti_elitism ~
            gender + age + as.factor(education) + as.factor(household_income) + left_right_scale,
          data = cses_isr %>% labelled::remove_labels())

sjPlot::tab_model(m_1,
                  p.style = "numeric_stars",
                  collapse.se = T,
                  show.ci = F,
                  show.se = T,
                  emph.p = F,
                  show.aic = T,
                  show.loglik = T,
                  digits = 3,
                  dv.labels = c("(1) anti_elitism"))
```

