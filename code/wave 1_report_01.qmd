---
title: "Populism stereotype wave 1"
author: "Saar Alon-Barkat"
date: "January 2025"
format:
  html:
    self-contained: true
    code-fold: true
    toc: true
    toc-location: left
execute:
  message: false
  warning: false
---


```{r}
library(tidyverse)
library(gt)
library(gtsummary)
library(sjPlot)
library(haven)
library(labelled)
library(codebook)
library(janitor)
library(lavaan)
```

Import data

```{r}
load(".RData")
```


# sample

```{r}
# יצירת labels למשתנים
wave1_labs <- wave1 %>% remove_labels() %>%
  mutate(
    gender_label = case_when(
      gender == 1 ~ "Male",
      gender == 2 ~ "Female",
      gender == 3 ~ "Other",
      TRUE ~ NA_character_
    ),
    age_group_label = case_when(
      age_group == 1 ~ "18-24",
      age_group == 2 ~ "25-34",
      age_group == 3 ~ "35-44",
      age_group == 4 ~ "45-54",
      age_group == 5 ~ "55-64",
      age_group == 6 ~ "65+",
      TRUE ~ NA_character_
    ),
    education_label = case_when(
      education == 1 ~ "1.Elementary or less",
      education == 2 ~ "2.No high school disploma",
      education == 3 ~ "3.High school disploma",
      education == 4 ~ "4.Post high school",
      education == 5 ~ "5.College education (no degree)",
      education == 6 ~ "6.Bachelor's degree",
      education == 7 ~ "7.Master's degree",
      education == 8 ~ "8.Doctorate degree",
      TRUE ~ NA_character_
    ),
    income_label = case_when(
      income == 1 ~ "1.Much below average",
      income == 2 ~ "2.Below average",
      income == 3 ~ "3.Average",
      income == 4 ~ "4.Above average",
      income == 5 ~ "5.Much above average",
      TRUE ~ NA_character_
    ),
    sector_employment_label = case_when(
      sector_employment == 1 ~ "Public sector",
      sector_employment == 2 ~ "Private sector",
      sector_employment == 3 ~ "Third sector",
      sector_employment == 4 ~ "Self-employed",
      sector_employment == 5 ~ "Not employed",
      sector_employment == 6 ~ "Other",
      TRUE ~ NA_character_
    ),
    religiosity_label = case_when(
      religiosity == 1 ~ "5.Ultra Orthodox (Charedi)",
      religiosity == 3 ~ "4.Religious",
      religiosity == 4 ~ "3.Traditional religious",
      religiosity == 5 ~ "2.Traditional not religious",
      religiosity == 6 ~ "1.Secular",
      TRUE ~ NA_character_
    )
  )

```

```{r}
# בחירת משתנים דמוגרפיים
wave1_labs %>%
  dplyr::select(gender_label, age_group_label, religiosity_label,education_label, income_label, 
         sector_employment_label, public_sector_employee_current, 
         public_sector_experience, right_left_ideology,coalition_party_vote_intention,
         ) %>%
  tbl_summary(
    label = list(
      gender_label ~ "Gender",
      age_group_label ~ "Age Group",
      religiosity_label ~ "Religiosity",
      education_label ~ "Education",
      income_label ~ "Income (relative to average)",
      sector_employment_label ~ "Employment Sector",
      public_sector_employee_current ~ "Currently employed in public sector",
      public_sector_experience ~ "Any public sector experience",
      right_left_ideology ~ "Right-Left Ideology (1=extreme right, 7=extreme left)"
    ),
    missing_text = "Missing"
  ) %>%
  modify_caption("**Table 1. Sample Demographics**") %>%
  bold_labels()

```




# Populist attitudes

**popular sovereignty**

-   **pop1 המילה האחרונה בהחלטות הפוליטיות החשובות ביותר, צריכה להיות של העם (למשל באמצעות משאל עם)**
-   **pop2 בהכרעות פוליטיות חשובות, חייבים לשאול לדעתו של העם**
-   **pop3 העם, ולא נבחרי הציבור, צריכים להיות אלה שמקבלים את החלטות המדיניות החשובות ביותר**

**Anti elitism**

-   **pop4 ההבדלים בין האליטות לעם הם הרבה יותר גדולים מאשר ההבדלים בתוך העם עצמו**
-   **pop5 המדינה שלנו מנוהלת בפועל על ידי קבוצה קטנה של בעלי אינטרס חזקים הפועלים לטובת עצמם**
-   **pop6 אליטות שלא נותנות דין וחשבון לאף אחד מונעות מהאזרחים הפשוטים לשפר את חייהם**
-   **pop7 לא משנה את מי העם בוחר בבחירות, בסוף מי שקובע באמת מה תהיה המדיניות הן האליטות ששולטות במדינה**

**Homogeneity**

-   **pop8 האנשים הפשוטים פועלים יחד ובשיתוף פעולה**
-   **pop9 אנשים פשוטים הם טובים וישרים**
-   **pop10 האנשים הרגילים חולקים את אותם ערכים ואינטרסים**

**Menichean**

-   **pop11 בסופו של דבר, פוליטיקה היא מאבק בין העם לבעלי הכוח**
-   **pop12 פוליטיקה היא למעשה מאבק בין טוב לרע**
-   **pop13 מה שאנשים מכנים 'פשרה' בפוליטיקה הוא למעשה ויתור על עקרונות**


```{r}
# bar plot for each populist attitude item - across pro_netanyahu_coalition

wave1 %>%
  pivot_longer(cols = pop1:pop3, names_to = "item", values_to = "response") %>%
  ggplot(aes(x = response, fill = pro_netanyahu_coalition %>% labelled::to_factor())) +
  geom_bar(position = "dodge") +
  facet_wrap(~ item, scales = "free_y") +
  labs(
    x = "Response",
    y = "Count",
    fill = "Pro Netanyahu Coalition",
    title = "Distribution of Popular sovereignty Items by Pro Netanyahu Coalition"
  ) +
  theme_minimal()
```

```{r}
# bar plot for each populist attitude item - across pro_netanyahu_coalition

wave1 %>%
  pivot_longer(cols = pop4:pop7, names_to = "item", values_to = "response") %>%
  ggplot(aes(x = response, fill = pro_netanyahu_coalition %>% labelled::to_factor())) +
  geom_bar(position = "dodge") +
  facet_wrap(~ item, scales = "free_y") +
  labs(
    x = "Response",
    y = "Count",
    fill = "Pro Netanyahu Coalition",
    title = "Distribution of anti elitism Items by Pro Netanyahu Coalition"
  ) +
  theme_minimal()
```


```{r}
# bar plot for each populist attitude item - across pro_netanyahu_coalition

wave1 %>%
  pivot_longer(cols = pop8:pop10, names_to = "item", values_to = "response") %>%
  ggplot(aes(x = response, fill = pro_netanyahu_coalition %>% labelled::to_factor())) +
  geom_bar(position = "dodge") +
  facet_wrap(~ item, scales = "free_y") +
  labs(
    x = "Response",
    y = "Count",
    fill = "Pro Netanyahu Coalition",
    title = "Distribution of Homogeneity Items by Pro Netanyahu Coalition"
  ) +
  theme_minimal()
```

```{r}
# bar plot for each populist attitude item - across pro_netanyahu_coalition

wave1 %>%
  pivot_longer(cols = pop11:pop13, names_to = "item", values_to = "response") %>%
  ggplot(aes(x = response, fill = pro_netanyahu_coalition %>% labelled::to_factor())) +
  geom_bar(position = "dodge") +
  facet_wrap(~ item, scales = "free_y") +
  labs(
    x = "Response",
    y = "Count",
    fill = "Pro Netanyahu Coalition",
    title = "Distribution of Menichean Items by Pro Netanyahu Coalition"
  ) +
  theme_minimal()
```

```{r}
wave1 %>% 
  dplyr::select(pop1_n:pop13_n) %>% 
  sjPlot::tab_corr()
```

## Alpha

```{r}
wave1 %>% 
  dplyr::select(pop1_n:pop13_n) %>% 
  sjPlot::tab_itemscale()
```

popular sovereignty

```{r}
wave1 %>% 
  dplyr::select(pop1_n:pop3_n) %>% 
  sjPlot::tab_itemscale()
```

Anti elitism

```{r}
wave1 %>% 
  dplyr::select(pop4_n:pop7_n) %>% 
  sjPlot::tab_itemscale()
```

Homogeneity

```{r}
wave1 %>% 
  dplyr::select(pop8_n:pop10_n) %>% 
  sjPlot::tab_itemscale()
```

Menichean

```{r}
wave1 %>% 
  dplyr::select(pop11_n:pop13_n) %>% 
  sjPlot::tab_itemscale()
```



```{r}
wave1 |> 
  ggplot(aes(x=populist_attitudes_index_4dim,y=trust_civil_service,color=pro_netanyahu_coalition)) +
geom_jitter()  +
geom_smooth(method='lm')


wave1 |> 
  ggplot(aes(x=pop5_n,y=trust_government,color=pro_netanyahu_coalition)) +
geom_jitter()  +
geom_smooth(method='lm')

```

## CFA

### 1 factor

```{r}
cfa.model.1factor <- '
  one_factor =~ pop1_n + pop2_n + pop3_n + pop4_n + pop5_n +
                pop6_n + pop7_n + pop8_n + pop9_n + pop10_n +
                pop11_n + pop12_n + pop13_n +
                pop11_n + pop12_n + pop13_n'

fit.cfa.model.1factor <- cfa(cfa.model.1factor,# model formula,
                             data = wave1,
                             se = "robust",
                             std.lv = T)

summary(fit.cfa.model.1factor, fit.measures = TRUE, standardize = TRUE)
```

### 3 factor model adjusted

```{r}
cfa.model.3factor <- '
  Popular_sovereignty =~ pop1_n + pop2_n + pop3_n
  Anti_elitism =~ pop4_n + pop5_n + pop6_n + pop7_n
  Homogeneity =~  pop8_n + pop9_n + pop10_n'

fit.cfa.model.3factor <- cfa(cfa.model.3factor,# model formula,
                             data = wave1,
                             se = "robust",
                             std.lv = T)

summary(fit.cfa.model.3factor, fit.measures = TRUE, standardize = TRUE)
```

```{r}
parameterEstimates(fit.cfa.model.3factor, standardized=TRUE) %>% 
  filter(op == "=~") %>% 
  mutate(Beta = str_c(std.all %>% round(3)," (",pvalue %>% round(3),")")) %>% 
    dplyr::select('Latent Factor'=lhs,  
           'Indicator' = rhs,
           'Estimate std.' = Beta) %>% 
  kableExtra::kable(digits = 3) %>% 
    kableExtra::kable_styling(bootstrap_options = c("condensed"),
                full_width = F,
                position = "left")%>%
  kableExtra::collapse_rows(columns = 1, valign = "top")
```

```{r}
fitmeasures(fit.cfa.model.3factor, c('chisq','df','pvalue','cfi','tli', 'rmsea', 'rmsea.ci.upper','rmsea.ci.lower', 'srmr')) %>% 
  broom::tidy() %>% 
  pivot_wider(names_from = names,values_from = x) %>% 
  mutate(chisq_01 = str_c(chisq %>% round(3)," [","df=",df,", p=",pvalue %>% round(3),"]"),
         rmsea_01 = str_c(rmsea %>% round(3)," CI[", rmsea.ci.lower %>% round(3),",",rmsea.ci.upper %>% round(3),"]"),
         cfi = cfi %>% round(3),
         tli = tli %>% round(3),
         srmr = srmr %>% round(3),
         n = fit.cfa.model.3factor@SampleStats@nobs) %>%
  dplyr::select('N' = n,
          'Chi-sq' = chisq_01,
         'CFI' = cfi,
         'TLI' = tli,
         'RMSEA' = rmsea_01,
         'SRMR' = srmr) %>% 
  t() %>% 
  kableExtra::kable()
```


### 4 factor model adjusted

```{r}
cfa.model.4factor <- '
  Popular_sovereignty =~ pop1_n + pop2_n + pop3_n
  Anti_elitism =~ pop4_n + pop5_n + pop6_n + pop7_n
  Homogeneity =~  pop8_n + pop9_n + pop10_n
  Manichean =~ pop11_n + pop12_n + pop13_n'

fit.cfa.model.4factor <- cfa(cfa.model.4factor,# model formula,
                             data = wave1,
                             se = "robust",
                             std.lv = T)

summary(fit.cfa.model.4factor, fit.measures = TRUE, standardize = TRUE)
```

```{r}
parameterEstimates(fit.cfa.model.4factor, standardized=TRUE) %>% 
  filter(op == "=~") %>% 
  mutate(Beta = str_c(std.all %>% round(3)," (",pvalue %>% round(3),")")) %>% 
    dplyr::select('Latent Factor'=lhs,  
           'Indicator' = rhs,
           'Estimate std.' = Beta) %>% gt::gt() 
```

```{r}
fitmeasures(fit.cfa.model.4factor, c('chisq','df','pvalue','cfi','tli', 'rmsea', 'rmsea.ci.upper','rmsea.ci.lower', 'srmr')) %>% 
  broom::tidy() %>% 
  pivot_wider(names_from = names,values_from = x) %>% 
  mutate(chisq_01 = str_c(chisq %>% round(3)," [","df=",df,", p=",pvalue %>% round(3),"]"),
         rmsea_01 = str_c(rmsea %>% round(3)," CI[", rmsea.ci.lower %>% round(3),",",rmsea.ci.upper %>% round(3),"]"),
         cfi = cfi %>% round(3),
         tli = tli %>% round(3),
         srmr = srmr %>% round(3),
         n = fit.cfa.model.4factor@SampleStats@nobs) %>%
  dplyr::select('N' = n,
          'Chi-sq' = chisq_01,
         'CFI' = cfi,
         'TLI' = tli,
         'RMSEA' = rmsea_01,
         'SRMR' = srmr) %>% 
  t() %>% 
  kableExtra::kable()
```


## Destribution of dimensions (scales)

```{r}
wave1 %>% 
  dplyr::select(popular_sovereignty:populist_attitudes_index_3dim) %>% 
  sjmisc::descr() |> 
  gt::gt()
```

```{r}
hist(wave1$popular_sovereignty)
hist(wave1$anti_elitism)
hist(wave1$homogeneity)
hist(wave1$manichean)

hist(wave1$populist_attitudes_index_4dim)
hist(wave1$populist_attitudes_index_3dim)
```

```{r}

wave1 %>% 
  dplyr::select(popular_sovereignty:manichean) %>% 
GGally::ggpairs()
```


## INDEX

```{r}
wave1 <- wave1 |> 
  mutate(
    populist_attitudes_index_4dim_multiplication = (popular_sovereignty*anti_elitism*homogeneity*manichean),
    populist_attitudes_index_4dim_minimum = pmin(scale(popular_sovereignty),scale(anti_elitism),scale(homogeneity),scale(manichean)) |> scale(),
    populist_attitudes_index_3dim_minimum = pmin(scale(popular_sovereignty),scale(anti_elitism),scale(homogeneity)) |> scale()
    )
```

)

```{r}
min(wave1$populist_attitudes_index_4dim_minimum)
max(wave1$populist_attitudes_index_4dim_minimum)
hist(wave1$populist_attitudes_index_4dim_minimum)
```


```{r}
#ggplot2 histograms populist_attitudes_index_4dim and populist_attitudes_index_4dim_multiplication

wave1 |> 
  ggplot(aes(x = populist_attitudes_index_4dim)) +
  geom_histogram(binwidth = 0.1, fill = "blue", color = "black", alpha = 0.7) +
  labs(
    x = "Populist Attitudes Index (4 dimensions)",
    y = "Count",
    title = "Distribution of Populist Attitudes Index (4 dimensions)"
  ) +
  theme_minimal()


wave1 |> 
  ggplot(aes(x = populist_attitudes_index_4dim_multiplication)) +
  geom_histogram(binwidth = 0.1, fill = "blue", color = "black", alpha = 0.7) +
  labs(
    x = "Populist Attitudes Index (4 dimensions) multiplication",
    y = "Count",
    title = "Distribution of Populist Attitudes Index (4 dimensions)"
  ) +
  theme_minimal()

wave1 |> 
  ggplot(aes(x = populist_attitudes_index_4dim_minimum)) +
  geom_histogram(bins = 10, fill = "blue", color = "black", alpha = 0.7) +
  labs(
    x = "Populist Attitudes Index (4 dimensions) multiplication",
    y = "Count",
    title = "Distribution of Populist Attitudes Index (4 dimensions)"
  ) +
  theme_minimal()


```

```{r}
wave1 |> 
  ggplot(aes(x = populist_attitudes_index_4dim ,y= populist_attitudes_index_4dim_minimum)) +
  geom_point(alpha=0.2)+
  theme_minimal()
```

## Populist attitudes and partisanship

```{r}
wave1 %>%
  filter(party_vote_past!=9) %>% 
  mutate(
    party_vote_past = labelled::to_factor(party_vote_past)
  ) %>%
  group_by(party_vote_past) %>%
  mutate(mean_pop = mean(populist_attitudes_index_4dim, na.rm = TRUE)) %>%
  ungroup() %>%
  mutate(party_vote_past = fct_reorder(party_vote_past, mean_pop)) %>%
  ggplot(aes(x = party_vote_past, y = populist_attitudes_index_4dim)) +
  geom_point(alpha=0.2) +
  stat_summary(fun = mean, geom = "point", shape = 21, size = 3, fill = "red", color = "black") +
    stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = 0.2) +
coord_flip() +
  labs(
    x = NULL,
    y = "Populist Attitudes Index",
    title = "Populist Attitudes by Past Vote"
  ) +
  theme_minimal()
```

```{r}
wave1 %>%
    filter(party_vote_intention!=9) %>% 
  drop_na(party_vote_intention) %>% 
  mutate(
    party_vote_intention = labelled::to_factor(party_vote_intention)
  ) %>%
  group_by(party_vote_intention) %>%
  mutate(mean_pop = mean(populist_attitudes_index_4dim, na.rm = TRUE)) %>%
  ungroup() %>%
  mutate(party_vote_intention = fct_reorder(party_vote_intention, mean_pop)) %>%
  ggplot(aes(x = party_vote_intention, y = populist_attitudes_index_4dim)) +
  geom_point(alpha=0.2) +
  stat_summary(fun = mean, geom = "point", shape = 21, size = 3, fill = "red", color = "black") +
      stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = 0.2) +
coord_flip() +
  labs(
    x = NULL,
    y = "Populist Attitudes Index (4 dimensions)",
    title = "Populist Attitudes by Voting Intention"
  ) +
  theme_minimal()



wave1 %>%
    filter(party_vote_intention!=9) %>% 
  drop_na(party_vote_intention) %>% 
  mutate(
    party_vote_intention = labelled::to_factor(party_vote_intention)
  ) %>%
  group_by(party_vote_intention) %>%
  mutate(mean_pop = mean(populist_attitudes_index_3dim_minimum, na.rm = TRUE)) %>%
  ungroup() %>%
  mutate(party_vote_intention = fct_reorder(party_vote_intention, mean_pop)) %>%
  ggplot(aes(x = party_vote_intention, y = populist_attitudes_index_3dim_minimum)) +
  geom_point(alpha=0.2) +
  stat_summary(fun = mean, geom = "point", shape = 21, size = 3, fill = "red", color = "black") +
      stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = 0.2) +
coord_flip() +
  labs(
    x = NULL,
    y = "Populist Attitudes Index (3 dimensions) minimum",
    title = "Populist Attitudes by Voting Intention"
  ) +
  theme_minimal()

wave1 %>%
    filter(party_vote_intention!=9) %>% 
  drop_na(party_vote_intention) %>% 
  mutate(
    party_vote_intention = labelled::to_factor(party_vote_intention)
  ) %>%
  group_by(party_vote_intention) %>%
  mutate(mean_pop = mean(populist_attitudes_index_4dim_multiplication, na.rm = TRUE)) %>%
  ungroup() %>%
  mutate(party_vote_intention = fct_reorder(party_vote_intention, mean_pop)) %>%
  ggplot(aes(x = party_vote_intention, y = populist_attitudes_index_4dim_multiplication)) +
  geom_point(alpha=0.2) +
  stat_summary(fun = mean, geom = "point", shape = 21, size = 3, fill = "red", color = "black") +
      stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = 0.2) +
coord_flip() +
  labs(
    x = NULL,
    y = "Populist Attitudes Index (4 dimensions) multiplication",
    title = "Populist Attitudes by Voting Intention"
  ) +
  theme_minimal()
```

```{r}
wave1 %>%
  drop_na(right_left_ideology) %>% 
  ggplot(aes(x = right_left_ideology %>% labelled::to_factor(), y = populist_attitudes_index_4dim)) +
  geom_point(alpha=0.2) +
  stat_summary(fun = mean, geom = "point", shape = 21, size = 3, fill = "red", color = "black") +
      stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = 0.2) +
coord_flip() +
  labs(
    x = NULL,
    y = "Populist Attitudes index",
    title = "Populist Attitudes by Ideology"
  ) +
  theme_minimal()
```

```{r}
wave1 %>%
  drop_na(coalition_party_vote_past) %>% 
  ggplot(aes(x = coalition_party_vote_intention %>% labelled::to_factor(), y = populist_attitudes_index_4dim)) +
  geom_point(alpha=0.2) +
  stat_summary(fun = mean, geom = "point", shape = 21, size = 3, fill = "red", color = "black") +
      stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = 0.2) +
coord_flip() +
  labs(
    x = NULL,
    y = "Populist Attitudes index",
    title = "coalition_party_vote_past"
  ) +
  theme_minimal()
```

```{r}
wave1 %>%
  drop_na(pro_netanyahu_coalition) %>% 
  ggplot(aes(x = pro_netanyahu_coalition %>% labelled::to_factor(), y = populist_attitudes_index_4dim)) +
  geom_point(alpha=0.2) +
  stat_summary(fun = mean, geom = "point", shape = 21, size = 3, fill = "red", color = "black") +
      stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = 0.2) +
coord_flip() +
  labs(
    x = NULL,
    y = "Populist Attitudes index",
    title = "pro_netanyahu_coalition"
  ) +
  theme_minimal()
```

#### Anti elitism and partisanship

```{r}
wave1 |> labelled::to_factor() |> 
  dplyr::select(party_vote_past,
                party_vote_intention,
                pro_netanyahu_coalition,
                religiosity) %>% 
  gtsummary::tbl_summary(by=pro_netanyahu_coalition)
```

```{r}
wave1 |>
  labelled::to_factor() |>
  dplyr::select(
    party_vote_intention,
    party_vote_past,
    coalition_party_vote_intention
  ) %>%
  gtsummary::tbl_summary(by = coalition_party_vote_intention)
```

```{r}
wave1 %>%
      filter(party_vote_intention!=9) %>% 
  mutate(
    party_vote_past = labelled::to_factor(party_vote_past)
  ) %>%
  group_by(party_vote_past) %>%
  mutate(mean_pop = mean(anti_elitism, na.rm = TRUE)) %>%
  ungroup() %>%
  mutate(party_vote_past = fct_reorder(party_vote_past, mean_pop)) %>%
  ggplot(aes(x = party_vote_past, y = anti_elitism)) +
  geom_point(alpha=0.2) +
  stat_summary(fun = mean, geom = "point", shape = 21, size = 3, fill = "red", color = "black") +
    stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = 0.2) +
coord_flip() +
  labs(
    x = NULL,
    y = "Anti_elitism",
    title = "Populist Attitudes by Past Vote"
  ) +
  theme_minimal()
```

```{r}
wave1 %>%
      filter(party_vote_intention!=9) %>% 
  mutate(
    party_vote_intention = labelled::to_factor(party_vote_intention)
  ) %>%
  group_by(party_vote_intention) %>%
  mutate(mean_pop = mean(anti_elitism, na.rm = TRUE)) %>%
  ungroup() %>%
  mutate(party_vote_intention = fct_reorder(party_vote_intention, mean_pop)) %>%
  ggplot(aes(x = party_vote_intention, y = anti_elitism)) +
  geom_point(alpha=0.2) +
  stat_summary(fun = mean, geom = "point", shape = 21, size = 3, fill = "red", color = "black") +
      stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = 0.2) +
coord_flip() +
  labs(
    x = NULL,
    y = "Anti_elitism",
    title = "Populist Attitudes by Voting Intention"
  ) +
  theme_minimal()
```

```{r}
wave1 %>%
  mutate(
    political_block = labelled::to_factor(political_block)
  ) %>%
  group_by(political_block) %>%
  mutate(mean_pop = mean(anti_elitism, na.rm = TRUE)) %>%
  ungroup() %>%
  mutate(political_block = fct_reorder(political_block, mean_pop)) %>%
  ggplot(aes(x = political_block, y = anti_elitism)) +
  geom_point(alpha=0.2) +
  stat_summary(fun = mean, geom = "point", shape = 21, size = 3, fill = "red", color = "black") +
      stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = 0.2) +
coord_flip() +
  labs(
    x = NULL,
    y = "Anti_elitism",
    title = "Populist Attitudes by Voting Intention"
  ) +
  theme_minimal()
```

```{r}
wave1 %>%
  drop_na(right_left_ideology) %>% 
  ggplot(aes(x = right_left_ideology %>% labelled::to_factor(), y = anti_elitism)) +
  geom_point(alpha=0.2) +
  stat_summary(fun = mean, geom = "point", shape = 21, size = 3, fill = "red", color = "black") +
      stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = 0.2) +
coord_flip() +
  labs(
    x = NULL,
    y = "Populist Attitudes index",
    title = "Populist Attitudes by Ideology"
  ) +
  theme_minimal()
```





#### Homogeneity

```{r}
wave1 %>%
      filter(party_vote_intention!=9) %>% 
  mutate(
    party_vote_intention = labelled::to_factor(party_vote_intention)
  ) %>%
  group_by(party_vote_intention) %>%
  mutate(mean_pop = mean(homogeneity, na.rm = TRUE)) %>%
  ungroup() %>%
  mutate(party_vote_intention = fct_reorder(party_vote_intention, mean_pop)) %>%
  ggplot(aes(x = party_vote_intention, y = homogeneity)) +
  geom_point(alpha=0.2) +
  stat_summary(fun = mean, geom = "point", shape = 21, size = 3, fill = "red", color = "black") +
      stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = 0.2) +
coord_flip() +
  labs(
    x = NULL,
    y = "homogeneity",
    title = "homogeneity by Voting Intention"
  ) +
  theme_minimal()
```

```{r}
wave1 %>%
  drop_na(coalition_party_vote_intention) %>% 
  ggplot(aes(x = homogeneity, fill = coalition_party_vote_intention %>% labelled::to_factor())) +
  geom_bar(position=position_dodge()) +
  theme_minimal()
```

#### Popular suvrenity

```{r}
wave1 %>%
      filter(party_vote_intention!=9) %>% 
mutate(
    party_vote_intention = labelled::to_factor(party_vote_intention)
  ) %>%
  group_by(party_vote_intention) %>%
  mutate(mean_pop = mean(popular_sovereignty, na.rm = TRUE)) %>%
  ungroup() %>%
  mutate(party_vote_intention = fct_reorder(party_vote_intention, mean_pop)) %>%
  ggplot(aes(x = party_vote_intention, y = popular_sovereignty)) +
  geom_point(alpha=0.2) +
  stat_summary(fun = mean, geom = "point", shape = 21, size = 3, fill = "red", color = "black") +
      stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = 0.2) +
coord_flip() +
  labs(
    x = NULL,
    y = "popular_sovereignty",
    title = "popular_sovereignty by Voting Intention"
  ) +
  theme_minimal()
```

```{r}
wave1 %>%
  drop_na(coalition_party_vote_intention) %>% 
  ggplot(aes(x = popular_sovereignty, fill = coalition_party_vote_intention %>% labelled::to_factor())) +
  geom_bar(position=position_dodge()) +
  theme_minimal()
```






```{r}
wave1 %>%
      dplyr::select(populist_attitudes_index_4dim,
      anti_elitism,
      homogeneity,
      popular_sovereignty,
      manichean,
      pro_netanyahu_coalition) %>%
        gtsummary::tbl_summary(statistic = list(all_continuous() ~ "{mean} ({sd})"),by=pro_netanyahu_coalition)
```

### Correlations with other variables

```{r}
wave1 %>%
  drop_na(education) %>% 
  ggplot(aes(x = education %>% labelled::to_factor(), y = populist_attitudes_index_4dim)) +
  geom_point(alpha=0.2) +
  stat_summary(fun = mean, geom = "point", shape = 21, size = 3, fill = "red", color = "black") +
      stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = 0.2) +
coord_flip() +
  labs(
    x = NULL,
    y = "Populist Attitudes index",
    title = "Populist Attitudes by education"
  ) +
  theme_minimal()
```

```{r}
wave1 %>%
  drop_na(income) %>% 
  ggplot(aes(x = income %>% labelled::to_factor(), y = populist_attitudes_index_4dim)) +
  geom_point(alpha=0.2) +
  stat_summary(fun = mean, geom = "point", shape = 21, size = 3, fill = "red", color = "black") +
      stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = 0.2) +
coord_flip() +
  labs(
    x = NULL,
    y = "Populist Attitudes index",
    title = "Populist Attitudes by income"
  ) +
  theme_minimal()
```

```{r}
wave1_labs %>%
  drop_na(religiosity_label) %>% 
  ggplot(aes(x = religiosity_label %>% labelled::to_factor(), y = populist_attitudes_index_4dim)) +
  geom_boxplot() +
  stat_summary(fun = mean, geom = "point", shape = 21, size = 3, fill = "red", color = "black") +
      stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = 0.2) +
coord_flip() +
  labs(
    x = NULL,
    y = "Populist Attitudes index",
    title = "Populist Attitudes by religiosity"
  ) +
  theme_minimal()
```



```{r}
wave1 %>%
  drop_na(public_sector_employee_current, populist_attitudes_index_4dim) %>%
  mutate(public_sector_employee_current = labelled::to_factor(public_sector_employee_current)) %>%
  ggplot(aes(x = populist_attitudes_index_4dim, fill = public_sector_employee_current)) +
  geom_histogram(position = "identity", alpha = 0.5, bins = 30, color = "black") +
  labs(
    x = "Populist Attitudes Index",
    y = "Count",
    title = "Distribution of Populist Attitudes by public_sector_employee_current"
  ) +
  theme_minimal()
```

```{r}
wave1 %>%
  drop_na(gender, populist_attitudes_index_4dim) %>%
  mutate(gender = labelled::to_factor(gender)) %>%
  ggplot(aes(x = populist_attitudes_index_4dim, fill = gender)) +
  geom_histogram(position = "identity", alpha = 0.5, bins = 30, color = "black") +
  labs(
    x = "Populist Attitudes Index",
    y = "Count",
    title = "Distribution of Populist Attitudes by Gender"
  ) +
  theme_minimal()
```

```{r}
wave1 %>%
  drop_na(affect_right) %>% 
  ggplot(aes(x = affect_right %>% labelled::to_factor(), y = populist_attitudes_index_3dim)) +
  geom_boxplot() +
  stat_summary(fun = mean, geom = "point", shape = 21, size = 3, fill = "red", color = "black") +
      stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = 0.2) +
coord_flip() +
  labs(
    x = NULL,
    y = "Populist Attitudes index",
    title = "Populist Attitudes by affect_right"
  ) +
  theme_minimal()
```

```{r}
wave1 %>%
  drop_na(affect_left) %>% 
  ggplot(aes(x = affect_left %>% labelled::to_factor(), y = populist_attitudes_index_4dim)) +
  geom_boxplot() +
  stat_summary(fun = mean, geom = "point", shape = 21, size = 3, fill = "red", color = "black") +
      stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = 0.2) +
coord_flip() +
  labs(
    x = NULL,
    y = "Populist Attitudes index",
    title = "Populist Attitudes by affect_left"
  ) +
  theme_minimal()
```


```{r}
wave1 %>%
  drop_na(affective_polarization) %>% 
  ggplot(aes(x = affective_polarization %>% labelled::to_factor(), y = populist_attitudes_index_4dim)) +
  geom_boxplot() +
  stat_summary(fun = mean, geom = "point", shape = 21, size = 3, fill = "red", color = "black") +
      stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = 0.2) +
coord_flip() +
  labs(
    x = NULL,
    y = "Populist Attitudes index",
    title = "Populist Attitudes by affective_polarization"
  ) +
  theme_minimal()
```


```{r}
wave1 %>% 
  dplyr::select(populist_attitudes_index_4dim,
                populist_attitudes_index_3dim,
                populist_attitudes_index_4dim_minimum,
                populist_attitudes_index_4dim_multiplication,
                popular_sovereignty:manichean,
                female,
                age_group,
                income,
                subjective_social_economic_status,
                education,
                religiosity,
                right_left_ideology,
                external_efficecy,
                affect_right,
                affect_left,
                affective_polarization,
                general_trust) %>% labelled::remove_labels() %>% 
  sjPlot::tab_corr(triangle = "lower",
  show.p = TRUE,
  p.numeric = TRUE)
```

```{r}
model_1 <- lm(populist_attitudes_index_4dim ~ coalition_party_vote_intention + 
  female +
                age_group+
                income+
                education+
                right_left_ideology+
                external_efficecy+
                subjective_social_economic_status +
                affective_polarization,wave1 %>% labelled::remove_labels(),na.rm=T)

model_2 <- model_1 %>% update(popular_sovereignty~.)
model_3 <- model_1 %>% update(anti_elitism~.)
model_4 <- model_1 %>% update(homogeneity~.)
model_5 <- model_1 %>% update(manichean~.)


sjPlot::tab_model(model_1,model_2,model_3,model_4,model_5,
                  show.est = F,
                  show.std = T,
                  collapse.ci = T)
```

```{r}
#histogram for external_efficecy
wave1 |> 
  ggplot(aes(x = external_efficecy,fill=pro_netanyahu_coalition))+
  geom_histogram(binwidth = 0.5, color = "black", alpha = 0.7,position = position_dodge()) 
```



```{r}
wave1 %>%
  drop_na(external_efficecy) %>% 
  ggplot(aes(x = external_efficecy, y = populist_attitudes_index_4dim,color=pro_netanyahu_coalition)) +
  geom_jitter() +
  geom_smooth(method='lm')+
  theme_minimal()


```


```{r}
wave1 |> 
  ggplot(aes(x = external_efficecy, y = populist_attitudes_index_4dim)) +
  geom_jitter(alpha=0.2) +
  geom_smooth(method='lm',color='blue')+
  theme_minimal()

```




# Trust

```{r}
wave1 %>% labelled::remove_labels() %>% 
  dplyr::select(trust_knesset:trust_media,coalition_party_vote_intention) %>% 
  gtsummary::tbl_summary(
statistic = list(by="coalition_party_vote_intention"))
```

```{r}

wave1 %>% labelled::remove_labels() |> 
  group_by(coalition_party_vote_intention) |>
  summarise(
    across(trust_knesset:trust_media, ~mean(.x, na.rm=TRUE))
  )
```

```{r}
wave1 %>% labelled::remove_labels() %>% 
  dplyr::select(trust_knesset:trust_media) %>% 
  sjPlot::tab_itemscale()
```

```{r}
wave1 %>% labelled::remove_labels() %>% 
  dplyr::select(populist_attitudes_index_3dim,                popular_sovereignty:manichean,
trust_knesset:trust_media) %>% 
  sjPlot::tab_corr(triangle = "lower")
```

```{r}
t1 <- wave1 %>% 
  mutate(trust_index = (trust_knesset+
           trust_government+
           trust_judiciary+
           trust_health+
           trust_police+
           trust_municipality+
           trust_civil_service+
           trust_media)/8)


t1 %>% 
  dplyr::select(populist_attitudes_index_3dim,trust_index) %>% 
  sjPlot::tab_corr()
```

```{r}
wave1 %>% labelled::remove_labels() |> 
  dplyr::select(populist_attitudes_index_3dim,trust_knesset,
           trust_government,
           trust_judiciary,
           trust_health,
           trust_police,
           trust_municipality,
           trust_civil_service,
           trust_media) |> 
  sjPlot::tab_corr()
```

```{r}
wave1 %>%
  mutate(
    trust_government = labelled::to_factor(trust_government)
  ) %>%
  ggplot(aes(x = trust_government, y = populist_attitudes_index_3dim)) +
  geom_point(alpha=0.2) +
  stat_summary(fun = mean, geom = "point", shape = 21, size = 3, fill = "red", color = "black") +
    stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = 0.2) +
coord_flip() +
  labs(
    x = NULL,
    y = "Populist Attitudes Index",
    title = "Populist Attitudes by trust in government"
  ) +
  theme_minimal()
```

```{r}
wave1 %>%
  mutate(
    trust_government = labelled::to_factor(trust_government)
  ) %>%
  ggplot(aes(x = trust_government, y = populist_attitudes_index_3dim)) +
  geom_point(alpha=0.2) +
  stat_summary(fun = mean, geom = "point", shape = 21, size = 3, fill = "red", color = "black") +
    stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = 0.2) +
coord_flip() +
  labs(
    x = NULL,
    y = "Populist Attitudes Index",
    title = "Populist Attitudes by Past Vote"
  ) +
    facet_wrap(vars(coalition_party_vote_intention))+
  theme_minimal()
```

```{r}
tmod1 <- lm(trust_government ~ populist_attitudes_index_3dim, data=wave1 %>% labelled::remove_labels())
tmod2 <- tmod1 %>% update(.~.+ coalition_party_vote_intention)
tmod3 <- tmod1 %>% update(.~.,data=wave1 %>% labelled::remove_labels() %>% filter(coalition_party_vote_intention=="Netanyahu coalition"))
tmod4 <- tmod1 %>% update(.~.,data=wave1 %>% labelled::remove_labels() %>% filter(coalition_party_vote_intention=="Anti Netanyahu coalition"))
tmod5 <- tmod1 %>% update(.~.+ populist_attitudes_index_3dim*coalition_party_vote_intention)


sjPlot::tab_model(tmod1,tmod2,tmod3,tmod4,tmod5,
                  show.est = F,
                  show.std = T,
                  collapse.ci = T)
```

```{r}
sjPlot::plot_model(tmod5,type = "pred",terms = c("populist_attitudes_index_3dim", "coalition_party_vote_intention"))
```

```{r}
tmod1 <- lm(populist_attitudes_index_3dim ~ trust_knesset, data=wave1 %>% labelled::remove_labels())
tmod2 <- tmod1 %>% update(.~.,data=wave1 %>% labelled::remove_labels() %>% filter(coalition_party_vote_intention=="Netanyahu coalition"))
tmod3 <- tmod1 %>% update(.~.,data=wave1 %>% labelled::remove_labels() %>% filter(coalition_party_vote_intention=="Anti Netanyahu coalition"))


sjPlot::tab_model(tmod1,tmod2,tmod3,
                  show.est = F,
                  show.std = T,
                  collapse.ci = T)
```

```{r}
tmod1 <- lm(trust_civil_service ~ populist_attitudes_index_3dim, data=wave1 %>% labelled::remove_labels())
tmod2 <- tmod1 %>% update(.~.+ coalition_party_vote_intention)
tmod3 <- tmod1 %>% update(.~.,data=wave1 %>% labelled::remove_labels() %>% filter(coalition_party_vote_intention=="Netanyahu coalition"))
tmod4 <- tmod1 %>% update(.~.,data=wave1 %>% labelled::remove_labels() %>% filter(coalition_party_vote_intention=="Anti Netanyahu coalition"))
tmod5 <- tmod1 %>% update(.~.+ populist_attitudes_index_3dim*coalition_party_vote_intention)


sjPlot::tab_model(tmod1,tmod2,tmod3,tmod4,tmod5,
                  show.est = F,
                  show.std = T,
                  collapse.ci = T)
```

```{r}
sjPlot::plot_model(tmod5,type = "pred",terms = c("populist_attitudes_index_3dim", "coalition_party_vote_intention"))
```


Correlations between trust and populist attitudes across partisanship
```{r}
wave1 %>% labelled::remove_labels() %>% 
  dplyr::select(populist_attitudes_index_3dim,                popular_sovereignty:manichean,
trust_knesset:trust_media) %>% 
  sjPlot::tab_corr(triangle = "lower",
  title = "All respondents")
```

```{r}
wave1 %>% filter(coalition_party_vote_intention=="Netanyahu coalition") %>% labelled::remove_labels() %>%
  dplyr::select(populist_attitudes_index_3dim,                popular_sovereignty:manichean,
trust_knesset:trust_media) %>% 
  sjPlot::tab_corr(triangle = "lower",
  title = "Netanyahu coalition")
```

```{r}
wave1 %>% filter(coalition_party_vote_intention=="Anti Netanyahu coalition") %>% labelled::remove_labels() %>%
  dplyr::select(populist_attitudes_index_3dim,                popular_sovereignty:manichean,
trust_knesset:trust_media) %>% 
  sjPlot::tab_corr(triangle = "lower",
  title = "Anti Netanyahu coalition")
```



```{r}
##ggplot2 histogram of trust in civil service

wave1 |> 
  labelled::remove_labels() |> 
  ggplot(aes(x = trust_civil_service)) +
  geom_histogram(binwidth = 1, fill = "blue", color = "black", alpha = 0.7) +
  labs(
    title = "Distribution of Trust in Civil Service",
    x = "Trust in Civil Service Score",
    y = "Count"
  ) +
  theme_minimal()

```


```{r}
##ggplot2 histogram of trust in civil service

wave1 |> 
  labelled::remove_labels() |> 
  ggplot(aes(x = trust_civil_service)) +
  geom_histogram(binwidth = 1, fill = "blue", color = "black", alpha = 0.7) +
  facet_wrap(vars(coalition_party_vote_intention))+
  labs(
    title = "Distribution of Trust in Civil Service",
    x = "Trust in Civil Service Score",
    y = "Count"
  ) +
  theme_minimal()

```

```{r}
model_1 <- lm(trust_civil_service ~ populist_attitudes_index_4dim + pro_netanyahu_coalition + right_left_ideology ,wave1 %>% labelled::remove_labels(),na.rm=T)

model_2 <- model_1 %>% update(.~.+populist_attitudes_index_4dim*(pro_netanyahu_coalition))

model_3 <- model_1 %>% update(.~.+ 
  female +
                age_group+
                income+
                education+
                external_efficecy+
                subjective_social_economic_status +
                affective_polarization)
model_4 <- model_3 %>% update(.~.+populist_attitudes_index_4dim*(pro_netanyahu_coalition))



sjPlot::tab_model(model_1,model_2,model_3,model_4,
                  show.est = F,
                  show.std = T,
                  collapse.ci = T)
```

```{r}
sjPlot::plot_model(model_4,type = "pred",terms = c("populist_attitudes_index_4dim", "pro_netanyahu_coalition"))
```

```{r}
anova(model_4)
```

```{r}
model_1 <- lm(trust_civil_service ~ anti_elitism + pro_netanyahu_coalition + right_left_ideology ,wave1 %>% labelled::remove_labels(),na.rm=T)

model_2 <- model_1 %>% update(.~.+populist_attitudes_index_4dim*(pro_netanyahu_coalition))

model_3 <- model_1 %>% update(.~.+ 
  female +
                age_group+
                income+
                education+
                external_efficecy+
                subjective_social_economic_status +
                affective_polarization)
model_4 <- model_3 %>% update(.~.+populist_attitudes_index_4dim*(pro_netanyahu_coalition))



sjPlot::tab_model(model_1,model_2,model_3,model_4,
                  show.est = F,
                  show.std = T,
                  collapse.ci = T)
```

```{r}
sjPlot::plot_model(model_4,type = "pred",terms = c("populist_attitudes_index_4dim", "pro_netanyahu_coalition"))
```



```{r}
##ggplot2 histogram of trust in police

wave1 |> 
  labelled::remove_labels() |> 
  ggplot(aes(x = trust_police)) +
  geom_histogram(binwidth = 1, fill = "blue", color = "black", alpha = 0.7) +
  facet_wrap(vars(coalition_party_vote_intention))+
  labs(
    title = "Distribution of Trust in Civil Service",
    x = "Trust in Civil Service Score",
    y = "Count"
  ) +
  theme_minimal()

```

```{r}
model_1 <- lm(trust_police ~ populist_attitudes_index_4dim + pro_netanyahu_coalition + right_left_ideology ,wave1 %>% labelled::remove_labels(),na.rm=T)

model_2 <- model_1 %>% update(.~.+populist_attitudes_index_4dim*(pro_netanyahu_coalition))

model_3 <- model_1 %>% update(.~.+ 
  female +
                age_group+
                income+
                education+
                external_efficecy+
                subjective_social_economic_status +
                affective_polarization)
model_4 <- model_3 %>% update(.~.+populist_attitudes_index_4dim*(pro_netanyahu_coalition))
model_5 <- lm(trust_police ~ populist_attitudes_index_4dim + right_left_ideology ,wave1 %>% labelled::remove_labels() |> filter(coalition_party_vote_intention=="Netanyahu coalition"))


sjPlot::tab_model(model_1,model_2,model_3,model_4,model_5,
                  show.est = F,
                  show.std = T,
                  collapse.ci = T)
```

```{r}
sjPlot::plot_model(model_4,type = "pred",terms = c("populist_attitudes_index_4dim", "pro_netanyahu_coalition"))
```



```{r}
model_1 <- lm(trust_media ~ populist_attitudes_index_4dim + pro_netanyahu_coalition + right_left_ideology ,wave1 %>% labelled::remove_labels(),na.rm=T)

model_2 <- model_1 %>% update(.~.+populist_attitudes_index_4dim*(pro_netanyahu_coalition))

model_3 <- model_1 %>% update(.~.+ 
  female +
                age_group+
                income+
                education+
                external_efficecy+
                subjective_social_economic_status +
                affective_polarization)
model_4 <- model_3 %>% update(.~.+populist_attitudes_index_4dim*(pro_netanyahu_coalition))



sjPlot::tab_model(model_1,model_2,model_3,model_4,
                  show.est = F,
                  show.std = T,
                  collapse.ci = T)
```

```{r}
sjPlot::plot_model(model_4,type = "pred",terms = c("populist_attitudes_index_4dim", "pro_netanyahu_coalition"))
```

```{r}
anova(model_4)
```


```{r}
model_1 <- lm(trust_police ~ anti_elitism + coalition_party_vote_intention + right_left_ideology ,wave1 %>% labelled::remove_labels(),na.rm=T)

model_2 <- model_1 %>% update(.~.+anti_elitism*(coalition_party_vote_intention+right_left_ideology))

model_3 <- model_1 %>% update(.~.+ 
  female +
                age_group+
                income+
                education+
                external_efficecy+
                subjective_social_economic_status +
                affective_polarization)
model_4 <- model_3 %>% update(.~.+anti_elitism*(coalition_party_vote_intention+right_left_ideology))



sjPlot::tab_model(model_1,model_2,model_3,model_4,
                  show.est = F,
                  show.std = T,
                  collapse.ci = T)
```

```{r}
sjPlot::plot_model(model_4,type = "pred",terms = c("anti_elitism", "coalition_party_vote_intention"))
```








# Conspiracy

```{r}
##ggplot2 histogram of conspiracy beliefs

wave1 |> 
  labelled::remove_labels() |> 
  ggplot(aes(x = conspiracy_deep_state_n)) +
  geom_histogram(binwidth = 1, fill = "blue", color = "black", alpha = 0.7) +
  labs(
    title = "Distribution of Deep State Conspiracy Beliefs",
    x = "Deep State Conspiracy Belief Score",
    y = "Count"
  ) +
  theme_minimal()

```


```{r}
wave1 %>%
  drop_na(party_vote_intention) %>% 
  ggplot(aes(x = party_vote_intention %>% labelled::to_factor(), y = conspiracy_deep_state_n)) +
  stat_summary(fun = mean, geom = "point", shape = 21, size = 3, fill = "red", color = "black") +
      stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = 0.2) +
coord_flip() +
labs(x = NULL,
    y = "Deep State Conspiracy Belief Score",
    title = "Deep State Conspiracy Beliefs by Voting Intention"
  ) +
  theme_minimal()
```

```{r}
wave1 %>%
  drop_na(coalition_party_vote_intention) %>% 
  ggplot(aes(x = coalition_party_vote_intention %>% labelled::to_factor(), y = conspiracy_deep_state_n)) +
  stat_summary(fun = mean, geom = "point", shape = 21, size = 3, fill = "red", color = "black") +
      stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = 0.2) +
coord_flip() +
labs(x = NULL,
    y = "Deep State Conspiracy Belief Score",
    title = "Deep State Conspiracy Beliefs by Voting Intention coalition"
  ) +
  theme_minimal()
```

```{r}
wave1 %>% labelled::remove_labels() %>% 
  dplyr::select(populist_attitudes_index_4dim,                popular_sovereignty:manichean,
conspiracy_deep_state_n,conspiracy_vaccine_n) %>% 
  sjPlot::tab_corr(triangle = "lower")

```

```{r}
wave1 %>% labelled::remove_labels() %>% 
  dplyr::select(populist_attitudes_index_4dim,                popular_sovereignty:manichean,
conspiracy_deep_state_n,conspiracy_vaccine_n,
trust_knesset:trust_media) %>% 
  sjPlot::tab_corr(triangle = "lower")

```


Correlations between trust and populist attitudes across partisanship
```{r}
wave1 %>%
  labelled::remove_labels() %>%
  dplyr::select(
    populist_attitudes_index_4dim, 
        popular_sovereignty:manichean,
    conspiracy_deep_state_n,
    conspiracy_vaccine_n,
    trust_knesset:trust_media
  ) %>%
  sjPlot::tab_corr(triangle = "lower", title = "All respondents")
```

```{r}
wave1 %>%
  filter(coalition_party_vote_intention == "Netanyahu coalition") %>%
  labelled::remove_labels() %>%
  dplyr::select(
    populist_attitudes_index_4dim,populist_attitudes_index_4dim,
        popular_sovereignty:manichean,
    conspiracy_deep_state_n,
    conspiracy_vaccine_n,
    trust_knesset:trust_media
  ) %>%
  sjPlot::tab_corr(triangle = "lower", title = "Netanyahu coalition",p.numeric=TRUE)
```

```{r}
wave1 %>%
  filter(coalition_party_vote_intention == "Anti Netanyahu coalition") %>%
  labelled::remove_labels() %>%
  dplyr::select(
    populist_attitudes_index_4dim,populist_attitudes_index_4dim,
        popular_sovereignty:manichean,
    conspiracy_deep_state_n,
    conspiracy_vaccine_n,
    trust_knesset:trust_media
  ) %>%
  sjPlot::tab_corr(triangle = "lower", title = "Anti Netanyahu coalition",p.numeric=TRUE)
```

Models for deep state conspiracy belief


```{r}
model_1 <- lm(conspiracy_deep_state_n ~ populist_attitudes_index_4dim + pro_netanyahu_coalition + right_left_ideology ,wave1 %>% labelled::remove_labels(),na.rm=T)

model_2 <- model_1 %>% update(conspiracy_deep_state_n~.+populist_attitudes_index_4dim*(pro_netanyahu_coalition))

model_3 <- model_1 %>% update(.~.+ 
  female +
                age_group+
                income+
                education+
                external_efficecy+
                subjective_social_economic_status +
                affective_polarization)
model_4 <- model_3 %>% update(conspiracy_deep_state_n~.+populist_attitudes_index_4dim*(pro_netanyahu_coalition))



sjPlot::tab_model(model_1,model_2,model_3,model_4,
                  show.est = F,
                  show.std = T,
                  collapse.ci = T)
```

```{r}
sjPlot::plot_model(model_4,type = "pred",terms = c("populist_attitudes_index_4dim", "pro_netanyahu_coalition"))
```

```{r}
anova(model_4)
```

Models for vaccine conspiracy belief


```{r}
model_1 <- lm(conspiracy_vaccine_n ~ populist_attitudes_index_4dim + pro_netanyahu_coalition + right_left_ideology ,wave1 %>% labelled::remove_labels(),na.rm=T)

model_2 <- model_1 %>% update(.~.+populist_attitudes_index_4dim*(pro_netanyahu_coalition))

model_3 <- model_1 %>% update(.~.+ 
  female +
                age_group+
                income+
                education+
                external_efficecy+
                subjective_social_economic_status +
                affective_polarization)
model_4 <- model_3 %>% update(conspiracy_vaccine_n~.+populist_attitudes_index_4dim*(pro_netanyahu_coalition))



sjPlot::tab_model(model_1,model_2,model_3,model_4,
                  show.est = F,
                  show.std = T,
                  collapse.ci = T)
```
```{r}
sjPlot::plot_model(model_4,type = "pred",terms = c("populist_attitudes_index_4dim", "pro_netanyahu_coalition"))
```
```{r}
anova(model_4)
```



# Elite groups


```{r}

wave1 |> 
  ggplot(aes(x=civil_servants_label %>% labelled::to_factor(), y=elite_group_civil_servants, color=pro_netanyahu_coalition))+
  stat_summary(fun=mean, geom="point", position=position_dodge(0.2),size=2)+
  stat_summary(fun.data=mean_cl_normal, geom="errorbar", position=position_dodge(0.2), width=0.2)+
  stat_summary(fun=mean, geom="line", aes(group=pro_netanyahu_coalition), position=position_dodge(0.2))+
  labs(
    x=NULL,
    y="Perception of civil servants as elite group",
    title="Perception of civil servants as elite group by partisanship",
        color="Partisanship"
  )+
    theme_minimal()




```


```{r}

wave1 |> 
  ggplot(aes(x=populist_attitudes_index_4dim, y=elite_group_civil_servants,color=civil_servants_label))+
geom_smooth(method="glm", method.args=list(family="binomial"))+
  labs(
    x=NULL,
    y="Perception of civil servants as elite group",
    title="Perception of civil servants as elite group by populist attitudes",
    color="Civil Servants Label"
  )+
    theme_minimal()


```

```{r}

wave1 |> 
  ggplot(aes(x=populist_attitudes_index_4dim, y=elite_group_civil_servants, color=civil_servants_label))+
geom_smooth(method="glm", method.args=list(family="binomial"))+
facet_grid(cols=vars(pro_netanyahu_coalition))+
  labs(
    x=NULL,
    y="Perception of civil servants as elite group",
    title="Perception of civil servants as elite group by populist attitudes and partisanship",
        color="Civil Servants Label"
  )+
    theme_minimal()




```



#  Attraction to work in public sector


```{r}
wave1 %>%
   pivot_longer(cols = attraction_public_sector_item1:attraction_public_sector_item3, names_to = "item", values_to = "response") %>%
   ggplot(aes(x = response, fill = pro_netanyahu_coalition %>% labelled::to_factor())) +
   geom_bar(position = "dodge") +
   facet_wrap(~ item, scales = "free_y") +
   labs(
     x = "Response",
    y = "Count",
    fill = "Pro Netanyahu Coalition",
   ) +
   theme_minimal()
```

```{r}
wave1 %>% 
  dplyr::select(attraction_public_sector_item1:attraction_public_sector_item3) %>% labelled::remove_labels() |> 
  sjPlot::tab_itemscale()
```

```{r}
hist(wave1$attraction_public_sector)
```

```{r}
wave1 %>%
   pivot_longer(cols = psm_aps_1:psm_aps_4, names_to = "item", values_to = "response") %>%
   ggplot(aes(x = response, fill = pro_netanyahu_coalition %>% labelled::to_factor())) +
   geom_bar(position = "dodge") +
   facet_wrap(~ item, scales = "free_y") +
   labs(
     x = "Response",
    y = "Count",
    fill = "Pro Netanyahu Coalition",
   ) +
   theme_minimal()
```

```{r}
wave1 %>% 
  dplyr::select(psm_aps_1:psm_aps_4) %>% labelled::remove_labels() |> 
  sjPlot::tab_itemscale()
```

```{r}
hist(wave1$psm_aps)
```

```{r}
wave1 |> 
  dplyr::select(populist_attitudes_index_4dim,
                popular_sovereignty:manichean,
                attraction_public_sector,
                psm_aps,
                elite_group_civil_servants) |> 
  sjPlot::tab_corr(triangle = "lower")
```


```{r}

wave1 |> 
  ggplot(aes(x=populist_attitudes_index_4dim, y=attraction_public_sector, color=pro_netanyahu_coalition))+
geom_smooth(method="lm")+
    theme_minimal()

```


```{r}
model1 <- lm(attraction_public_sector ~ populist_attitudes_index_4dim,wave1 %>% labelled::remove_labels(),na.rm=T)

model2 <- model1 |>update(.~.+ pro_netanyahu_coalition)
model3 <- model1 |>update(.~.+ psm_aps)
model4 <- model1 |>update(.~.+ income)


sjPlot::tab_model(model1,model2,model3,model4,
                  show.est = F,
                  show.std = T,
                  collapse.ci = T)
```