---
title: "Populism stereotype pilot 2 - codebook raw"
author: "Saar Alon-Barkat"
date: "August 2025"
format:
  html:
    self-contained: true
    code-fold: true
    toc: true
    toc-location: left
execute:
  message: false
  warning: false
---

```{r}
library(tidyverse)
library(gt)
library(gtsummary)
library(sjPlot)
library(haven)
library(labelled)
library(codebook)
library(janitor)
library(lavaan)
```

Import data

```{r}
load(".RData")
```


# sample

```{r}
# יצירת labels למשתנים
pilot2_labs <- pilot2 %>% remove_labels() %>%
  mutate(
    gender_label = case_when(
      gender == 1 ~ "Male",
      gender == 2 ~ "Female",
      gender == 3 ~ "Other",
      TRUE ~ NA_character_
    ),
    age_group_label = case_when(
      age_group == 1 ~ "18-24",
      age_group == 2 ~ "25-34",
      age_group == 3 ~ "35-44",
      age_group == 4 ~ "45-54",
      age_group == 5 ~ "55-64",
      age_group == 6 ~ "65+",
      TRUE ~ NA_character_
    ),
    education_label = case_when(
      education == 1 ~ "1.Elementary or less",
      education == 2 ~ "2.No high school disploma",
      education == 3 ~ "3.High school disploma",
      education == 4 ~ "4.Post high school",
      education == 5 ~ "5.College education (no degree)",
      education == 6 ~ "6.Bachelor's degree",
      education == 7 ~ "7.Master's degree",
      education == 8 ~ "8.Doctorate degree",
      TRUE ~ NA_character_
    ),
    income_label = case_when(
      income == 1 ~ "1.Much below average",
      income == 2 ~ "2.Below average",
      income == 3 ~ "3.Average",
      income == 4 ~ "4.Above average",
      income == 5 ~ "5.Much above average",
      TRUE ~ NA_character_
    ),
    sector_employment_label = case_when(
      sector_employment == 1 ~ "Public sector",
      sector_employment == 2 ~ "Private sector",
      sector_employment == 3 ~ "Third sector",
      sector_employment == 4 ~ "Self-employed",
      sector_employment == 5 ~ "Not employed",
      sector_employment == 6 ~ "Other",
      TRUE ~ NA_character_
    ),
    religiosity_label = case_when(
      religiosity == 1 ~ "5.Ultra Orthodox (Charedi)",
      religiosity == 3 ~ "4.Religious",
      religiosity == 4 ~ "3.Traditional religious",
      religiosity == 5 ~ "2.Traditional not religious",
      religiosity == 6 ~ "1.Secular",
      TRUE ~ NA_character_
    )
  ) |> mutate(
    party_vote_intention_en = case_when(
      party_vote_intention == 1 ~ "Likud",
      party_vote_intention == 2 ~ "Yesh Atid",
      party_vote_intention == 3 ~ "Religious Zionism",
      party_vote_intention == 4 ~ "The State Camp",
      party_vote_intention == 5 ~ "Shas",
      party_vote_intention == 6 ~ "United Torah Judaism",
      party_vote_intention == 7 ~ "Israel Beiteinu",
      party_vote_intention == 8 ~ "United Arab List (Ra'am)",
      party_vote_intention == 9 ~ "Hadash-Ta'al",
      party_vote_intention == 10 ~ "The Democrats (Labor-Meretz)",
      party_vote_intention == 11 ~ "Bennet Party",
      party_vote_intention == 12 ~ "Balad",
      party_vote_intention == 13 ~ "Jewish Power (Otzma Yehudit)",
      party_vote_intention == 14 ~ "Other party (specify)",
      party_vote_intention == 15 ~ "Don't know",
      TRUE ~ NA_character_
    )
  )

```

```{r}
# בחירת משתנים דמוגרפיים
pilot2_labs %>%
  dplyr::select(gender_label, age_group_label, religiosity_label,education_label, income_label, 
         sector_employment_label, public_sector_employee_current, 
         public_sector_experience, right_left_ideology,coalition_party_vote_intention,
         ) %>%
  tbl_summary(
    label = list(
      gender_label ~ "Gender",
      age_group_label ~ "Age Group",
      religiosity_label ~ "Religiosity",
      education_label ~ "Education",
      income_label ~ "Income (relative to average)",
      sector_employment_label ~ "Employment Sector",
      public_sector_employee_current ~ "Currently employed in public sector",
      public_sector_experience ~ "Any public sector experience",
      right_left_ideology ~ "Right-Left Ideology (1=extreme right, 7=extreme left)"
    ),
    missing_text = "Missing"
  ) %>%
  modify_caption("**Table 1. Sample Demographics**") %>%
  bold_labels()

```



# Populist attitudes

**popular sovereignty**

-   **pop1 המילה האחרונה בהחלטות הפוליטיות החשובות ביותר, צריכה להיות של העם (למשל באמצעות משאל עם)**
-   **pop2 בהכרעות פוליטיות חשובות, חייבים לשאול לדעתו של העם**
-   **pop3 העם, ולא נבחרי הציבור, צריכים להיות אלה שמקבלים את החלטות המדיניות החשובות ביותר**

**Anti elitism**

-   **pop4 ההבדלים בין האליטות לעם הם הרבה יותר גדולים מאשר ההבדלים בתוך העם עצמו**
-   **pop5 המדינה שלנו מנוהלת בפועל על ידי קבוצה קטנה של בעלי אינטרס חזקים הפועלים לטובת עצמם**
-   **pop6 אליטות שלא נותנות דין וחשבון לאף אחד מונעות מהאזרחים הפשוטים לשפר את חייהם**
-   **pop7 לא משנה את מי העם בוחר בבחירות, בסוף מי שקובע באמת מה תהיה המדיניות הן האליטות ששולטות במדינה**

**Homogeneity**

-   **pop8 האנשים הפשוטים פועלים יחד ובשיתוף פעולה**
-   **pop9 אנשים פשוטים הם טובים וישרים**
-   **pop10 האנשים הרגילים חולקים את אותם ערכים ואינטרסים**

**Menichean**

-   **pop11 בסופו של דבר, פוליטיקה היא מאבק בין העם לבעלי הכוח**
-   **pop12 פוליטיקה היא למעשה מאבק בין טוב לרע**
-   **pop13 מה שאנשים מכנים 'פשרה' בפוליטיקה הוא למעשה ויתור על עקרונות**

```{r}
pilot2 %>% 
  dplyr::select(pop1_n:pop13_n) %>% 
  sjPlot::tab_corr()
```

## Alpha

```{r}
pilot2 %>% 
  dplyr::select(pop1_n:pop13_n) %>% 
  sjPlot::tab_itemscale()
```

popular sovereignty

```{r}
pilot2 %>% 
  dplyr::select(pop1_n:pop3_n) %>% 
  sjPlot::tab_itemscale()
```

Anti elitism

```{r}
pilot2 %>% 
  dplyr::select(pop4_n:pop7_n) %>% 
  sjPlot::tab_itemscale()
```

Homogeneity

```{r}
pilot2 %>% 
  dplyr::select(pop8_n:pop10_n) %>% 
  sjPlot::tab_itemscale()
```

Menichean

```{r}
pilot2 %>% 
  dplyr::select(pop11_n:pop13_n) %>% 
  sjPlot::tab_itemscale()
```

## CFA

### 1 factor

```{r}
cfa.model.1factor <- '
  one_factor =~ pop1_n + pop2_n + pop3_n + pop4_n + pop5_n +
                pop6_n + pop7_n + pop8_n + pop9_n + pop10_n +
                pop11_n + pop12_n + pop13_n'

fit.cfa.model.1factor <- cfa(cfa.model.1factor,# model formula,
                             data = pilot2,
                             se = "robust",
                             std.lv = T)

summary(fit.cfa.model.1factor, fit.measures = TRUE, standardize = TRUE)
```

### 3 factor model adjusted

```{r}
cfa.model.3factor <- '
  Popular_sovereignty =~ pop1_n + pop2_n + pop3_n
  Anti_elitism =~ pop4_n + pop5_n + pop6_n + pop7_n
  Homogeneity =~  pop8_n + pop9_n + pop10_n'

fit.cfa.model.3factor <- cfa(cfa.model.3factor,# model formula,
                             data = pilot2,
                             se = "robust",
                             std.lv = T)

summary(fit.cfa.model.3factor, fit.measures = TRUE, standardize = TRUE)
```

```{r}
parameterEstimates(fit.cfa.model.3factor, standardized=TRUE) %>% 
  filter(op == "=~") %>% 
  mutate(Beta = str_c(std.all %>% round(3)," (",pvalue %>% round(3),")")) %>% 
    dplyr::select('Latent Factor'=lhs,  
           'Indicator' = rhs,
           'Estimate std.' = Beta) %>% 
  kableExtra::kable(digits = 3) %>% 
    kableExtra::kable_styling(bootstrap_options = c("condensed"),
                full_width = F,
                position = "left")%>%
  kableExtra::collapse_rows(columns = 1, valign = "top")
```

```{r}
fitmeasures(fit.cfa.model.3factor, c('chisq','df','pvalue','cfi','tli', 'rmsea', 'rmsea.ci.upper','rmsea.ci.lower', 'srmr')) %>% 
  broom::tidy() %>% 
  pivot_wider(names_from = names,values_from = x) %>% 
  mutate(chisq_01 = str_c(chisq %>% round(3)," [","df=",df,", p=",pvalue %>% round(3),"]"),
         rmsea_01 = str_c(rmsea %>% round(3)," CI[", rmsea.ci.lower %>% round(3),",",rmsea.ci.upper %>% round(3),"]"),
         cfi = cfi %>% round(3),
         tli = tli %>% round(3),
         srmr = srmr %>% round(3),
         n = fit.cfa.model.3factor@SampleStats@nobs) %>%
  dplyr::select('N' = n,
          'Chi-sq' = chisq_01,
         'CFI' = cfi,
         'TLI' = tli,
         'RMSEA' = rmsea_01,
         'SRMR' = srmr) %>% 
  t() %>% 
  kableExtra::kable()
```


### 4 factor model adjusted

```{r}
cfa.model.4factor <- '
  Popular_sovereignty =~ pop1_n + pop2_n + pop3_n
  Anti_elitism =~ pop4_n + pop5_n + pop6_n + pop7_n
  Homogeneity =~  pop8_n + pop9_n + pop10_n
  Manichean =~ pop11_n + pop12_n + pop13_n'

fit.cfa.model.4factor <- cfa(cfa.model.4factor,# model formula,
                             data = pilot2,
                             se = "robust",
                             std.lv = T)

summary(fit.cfa.model.4factor, fit.measures = TRUE, standardize = TRUE)
```

```{r}
parameterEstimates(fit.cfa.model.4factor, standardized=TRUE) %>% 
  filter(op == "=~") %>% 
  mutate(Beta = str_c(std.all %>% round(3)," (",pvalue %>% round(3),")")) %>% 
    dplyr::select('Latent Factor'=lhs,  
           'Indicator' = rhs,
           'Estimate std.' = Beta) %>% gt::gt() 
```

```{r}
fitmeasures(fit.cfa.model.4factor, c('chisq','df','pvalue','cfi','tli', 'rmsea', 'rmsea.ci.upper','rmsea.ci.lower', 'srmr')) %>% 
  broom::tidy() %>% 
  pivot_wider(names_from = names,values_from = x) %>% 
  mutate(chisq_01 = str_c(chisq %>% round(3)," [","df=",df,", p=",pvalue %>% round(3),"]"),
         rmsea_01 = str_c(rmsea %>% round(3)," CI[", rmsea.ci.lower %>% round(3),",",rmsea.ci.upper %>% round(3),"]"),
         cfi = cfi %>% round(3),
         tli = tli %>% round(3),
         srmr = srmr %>% round(3),
         n = fit.cfa.model.4factor@SampleStats@nobs) %>%
  dplyr::select('N' = n,
          'Chi-sq' = chisq_01,
         'CFI' = cfi,
         'TLI' = tli,
         'RMSEA' = rmsea_01,
         'SRMR' = srmr) %>% 
  t() %>% 
  kableExtra::kable()
```


## Destribution of dimensions (scales)

```{r}
pilot2 %>% 
  dplyr::select(popular_sovereignty:populist_attitudes_index_3dim) %>% 
  sjmisc::descr() %>% gt::gt()
```

```{r}
hist(pilot2$popular_sovereignty)
hist(pilot2$anti_elitism)
hist(pilot2$homogeneity)
hist(pilot2$manichean)

hist(pilot2$populist_attitudes_index_4dim)
hist(pilot2$populist_attitudes_index_3dim)
```

```{r}

pilot2 %>% 
  dplyr::select(popular_sovereignty:manichean) %>% 
GGally::ggpairs()
```


## INDEX

```{r}
pilot2 <- pilot2 |> 
  mutate(
    populist_attitudes_index_4dim_multiplication = (popular_sovereignty*anti_elitism*homogeneity*manichean),
    populist_attitudes_index_4dim_minimum = pmin(scale(popular_sovereignty),scale(anti_elitism),scale(homogeneity),scale(manichean)) |> scale(),
    populist_attitudes_index_3dim_minimum = pmin(scale(popular_sovereignty),scale(anti_elitism),scale(homogeneity)) |> scale()
    )
```

)

```{r}
min(pilot2$populist_attitudes_index_4dim_minimum)
max(pilot2$populist_attitudes_index_4dim_minimum)
hist(pilot2$populist_attitudes_index_4dim_minimum)
```


```{r}
#ggplot2 histograms populist_attitudes_index_4dim and populist_attitudes_index_4dim_multiplication

pilot2 |> 
  ggplot(aes(x = populist_attitudes_index_4dim)) +
  geom_histogram(binwidth = 0.1, fill = "blue", color = "black", alpha = 0.7) +
  labs(
    x = "Populist Attitudes Index (4 dimensions)",
    y = "Count",
    title = "Distribution of Populist Attitudes Index (4 dimensions)"
  ) +
  theme_minimal()


pilot2 |> 
  ggplot(aes(x = populist_attitudes_index_4dim_multiplication)) +
  geom_histogram(binwidth = 0.1, fill = "blue", color = "black", alpha = 0.7) +
  labs(
    x = "Populist Attitudes Index (4 dimensions) multiplication",
    y = "Count",
    title = "Distribution of Populist Attitudes Index (4 dimensions)"
  ) +
  theme_minimal()

pilot2 |> 
  ggplot(aes(x = populist_attitudes_index_4dim_minimum)) +
  geom_histogram(fill = "blue", color = "black", alpha = 0.7) +
  labs(
    x = "Populist Attitudes Index (4 dimensions) multiplication",
    y = "Count",
    title = "Distribution of Populist Attitudes Index (4 dimensions)"
  ) +
  theme_minimal()


```

```{r}
pilot2 |> 
  ggplot(aes(x = populist_attitudes_index_4dim ,y= populist_attitudes_index_4dim_minimum)) +
  geom_point(alpha=0.2)+
  theme_minimal()
```

```{r}
pilot2 %>% 
  dplyr::select(populist_attitudes_index_4dim,populist_attitudes_index_4dim_minimum) %>% 
  sjPlot::tab_corr()
```

## Populist attitudes and partisanship

```{r}
pilot2 %>%
  filter(party_vote_past!=9) %>% 
  mutate(
    party_vote_past = labelled::to_factor(party_vote_past)
  ) %>%
  group_by(party_vote_past) %>%
  mutate(mean_pop = mean(populist_attitudes_index_4dim, na.rm = TRUE)) %>%
  ungroup() %>%
  mutate(party_vote_past = fct_reorder(party_vote_past, mean_pop)) %>%
  ggplot(aes(x = party_vote_past, y = populist_attitudes_index_4dim)) +
  geom_point(alpha=0.2) +
  stat_summary(fun = mean, geom = "point", shape = 21, size = 3, fill = "red", color = "black") +
    stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = 0.2) +
coord_flip() +
  labs(
    x = NULL,
    y = "Populist Attitudes Index",
    title = "Populist Attitudes by Past Vote"
  ) +
  theme_minimal()
```

```{r}
pilot2_labs %>%
    filter(party_vote_intention!=9) %>% 
  drop_na(party_vote_intention) %>% 
  mutate(
    party_vote_intention = labelled::to_factor(party_vote_intention)
  ) %>%
  group_by(party_vote_intention_en) %>%
  mutate(mean_pop = mean(populist_attitudes_index_4dim, na.rm = TRUE)) %>%
  ungroup() %>%
  mutate(party_vote_intention_en = fct_reorder(party_vote_intention_en, mean_pop)) %>%
  ggplot(aes(x = party_vote_intention_en, y = populist_attitudes_index_4dim)) +
  geom_point(alpha=0.2) +
  stat_summary(fun = mean, geom = "point", shape = 21, size = 3, fill = "red", color = "black") +
      stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = 0.2) +
coord_flip() +
  labs(
    x = NULL,
    y = "Populist Attitudes Index (4 dimensions)",
    title = "Populist Attitudes by Voting Intention"
  ) +
  theme_minimal()



pilot2 %>%
    filter(party_vote_intention!=9) %>% 
  drop_na(party_vote_intention) %>% 
  mutate(
    party_vote_intention = labelled::to_factor(party_vote_intention)
  ) %>%
  group_by(party_vote_intention) %>%
  mutate(mean_pop = mean(populist_attitudes_index_3dim_minimum, na.rm = TRUE)) %>%
  ungroup() %>%
  mutate(party_vote_intention = fct_reorder(party_vote_intention, mean_pop)) %>%
  ggplot(aes(x = party_vote_intention, y = populist_attitudes_index_3dim_minimum)) +
  geom_point(alpha=0.2) +
  stat_summary(fun = mean, geom = "point", shape = 21, size = 3, fill = "red", color = "black") +
      stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = 0.2) +
coord_flip() +
  labs(
    x = NULL,
    y = "Populist Attitudes Index (3 dimensions) minimum",
    title = "Populist Attitudes by Voting Intention"
  ) +
  theme_minimal()

pilot2 %>%
    filter(party_vote_intention!=9) %>% 
  drop_na(party_vote_intention) %>% 
  mutate(
    party_vote_intention = labelled::to_factor(party_vote_intention)
  ) %>%
  group_by(party_vote_intention) %>%
  mutate(mean_pop = mean(populist_attitudes_index_4dim_multiplication, na.rm = TRUE)) %>%
  ungroup() %>%
  mutate(party_vote_intention = fct_reorder(party_vote_intention, mean_pop)) %>%
  ggplot(aes(x = party_vote_intention, y = populist_attitudes_index_4dim_multiplication)) +
  geom_point(alpha=0.2) +
  stat_summary(fun = mean, geom = "point", shape = 21, size = 3, fill = "red", color = "black") +
      stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = 0.2) +
coord_flip() +
  labs(
    x = NULL,
    y = "Populist Attitudes Index (4 dimensions) multiplication",
    title = "Populist Attitudes by Voting Intention"
  ) +
  theme_minimal()
```

```{r}
pilot2 |> 
  group_by(party_vote_intention) |>
  summarise(mean_populist_attitudes_index_4dim = mean(populist_attitudes_index_4dim, na.rm = TRUE),
            n = n())
            
```

```{r}
pilot2 %>%
  drop_na(right_left_ideology) %>% 
  ggplot(aes(x = right_left_ideology %>% labelled::to_factor(), y = populist_attitudes_index_4dim)) +
  geom_point(alpha=0.2) +
  stat_summary(fun = mean, geom = "point", shape = 21, size = 3, fill = "red", color = "black") +
      stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = 0.2) +
coord_flip() +
  labs(
    x = NULL,
    y = "Populist Attitudes index",
    title = "Populist Attitudes by Ideology"
  ) +
  theme_minimal()
```

```{r}
pilot2 %>%
  drop_na(coalition_party_vote_past) %>% 
  ggplot(aes(x = coalition_party_vote_intention %>% labelled::to_factor(), y = populist_attitudes_index_4dim)) +
  geom_point(alpha=0.2) +
  stat_summary(fun = mean, geom = "point", shape = 21, size = 3, fill = "red", color = "black") +
      stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = 0.2) +
coord_flip() +
  labs(
    x = NULL,
    y = "Populist Attitudes index",
    title = "coalition_party_vote_past"
  ) +
  theme_minimal()
```

```{r}
pilot2 %>%
  drop_na(coalition_party_vote_intention) %>% 
  ggplot(aes(x = coalition_party_vote_intention %>% labelled::to_factor(), y = populist_attitudes_index_4dim)) +
  geom_point(alpha=0.2) +
  stat_summary(fun = mean, geom = "point", shape = 21, size = 3, fill = "red", color = "black") +
      stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = 0.2) +
coord_flip() +
  labs(
    x = NULL,
    y = "Populist Attitudes index (4 dimensions)",
    title = "coalition_party_vote_intention"
  ) +
  theme_minimal()
```

#### Anti elitism and partisanship

```{r}
pilot2 |> labelled::to_factor() |> 
  dplyr::select(party_vote_past,
                party_vote_intention,
                coalition_party_vote_past) %>% 
  gtsummary::tbl_summary(by=coalition_party_vote_past)
```

```{r}
pilot2 |>
  labelled::to_factor() |>
  dplyr::select(
    party_vote_intention,
    party_vote_past,
    coalition_party_vote_intention
  ) %>%
  gtsummary::tbl_summary(by = coalition_party_vote_intention)
```

```{r}
pilot2 %>%
      filter(party_vote_intention!=9) %>% 
  mutate(
    party_vote_past = labelled::to_factor(party_vote_past)
  ) %>%
  group_by(party_vote_past) %>%
  mutate(mean_pop = mean(anti_elitism, na.rm = TRUE)) %>%
  ungroup() %>%
  mutate(party_vote_past = fct_reorder(party_vote_past, mean_pop)) %>%
  ggplot(aes(x = party_vote_past, y = anti_elitism)) +
  geom_point(alpha=0.2) +
  stat_summary(fun = mean, geom = "point", shape = 21, size = 3, fill = "red", color = "black") +
    stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = 0.2) +
coord_flip() +
  labs(
    x = NULL,
    y = "Anti_elitism",
    title = "Populist Attitudes by Past Vote"
  ) +
  theme_minimal()
```

```{r}
pilot2 %>%
      filter(party_vote_intention!=9) %>% 
  mutate(
    party_vote_intention = labelled::to_factor(party_vote_intention)
  ) %>%
  group_by(party_vote_intention) %>%
  mutate(mean_pop = mean(anti_elitism, na.rm = TRUE)) %>%
  ungroup() %>%
  mutate(party_vote_intention = fct_reorder(party_vote_intention, mean_pop)) %>%
  ggplot(aes(x = party_vote_intention, y = anti_elitism)) +
  geom_point(alpha=0.2) +
  stat_summary(fun = mean, geom = "point", shape = 21, size = 3, fill = "red", color = "black") +
      stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = 0.2) +
coord_flip() +
  labs(
    x = NULL,
    y = "Anti_elitism",
    title = "Populist Attitudes by Voting Intention"
  ) +
  theme_minimal()
```

```{r}
pilot2 %>%
  mutate(
    political_block = labelled::to_factor(political_block)
  ) %>%
  group_by(political_block) %>%
  mutate(mean_pop = mean(anti_elitism, na.rm = TRUE)) %>%
  ungroup() %>%
  mutate(political_block = fct_reorder(political_block, mean_pop)) %>%
  ggplot(aes(x = political_block, y = anti_elitism)) +
  geom_point(alpha=0.2) +
  stat_summary(fun = mean, geom = "point", shape = 21, size = 3, fill = "red", color = "black") +
      stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = 0.2) +
coord_flip() +
  labs(
    x = NULL,
    y = "Anti_elitism",
    title = "Populist Attitudes by Voting Intention"
  ) +
  theme_minimal()
```

```{r}
pilot2 %>%
  drop_na(right_left_ideology) %>% 
  ggplot(aes(x = right_left_ideology %>% labelled::to_factor(), y = anti_elitism)) +
  geom_point(alpha=0.2) +
  stat_summary(fun = mean, geom = "point", shape = 21, size = 3, fill = "red", color = "black") +
      stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = 0.2) +
coord_flip() +
  labs(
    x = NULL,
    y = "Populist Attitudes index",
    title = "Populist Attitudes by Ideology"
  ) +
  theme_minimal()
```

```{r}
pilot2 %>%
  drop_na(coalition_party_vote_intention) %>% 
  ggplot(aes(x = anti_elitism, fill = coalition_party_vote_intention %>% labelled::to_factor())) +
  geom_bar(position=position_dodge()) #+
coord_flip() +
  labs(
    x = NULL,
    y = "anti_elitism",
    title = "coalition_party_vote_intention"
  ) +
  theme_minimal()
```



#### Homogeneity

```{r}
pilot2 %>%
      filter(party_vote_intention!=9) %>% 
  mutate(
    party_vote_intention = labelled::to_factor(party_vote_intention)
  ) %>%
  group_by(party_vote_intention) %>%
  mutate(mean_pop = mean(homogeneity, na.rm = TRUE)) %>%
  ungroup() %>%
  mutate(party_vote_intention = fct_reorder(party_vote_intention, mean_pop)) %>%
  ggplot(aes(x = party_vote_intention, y = homogeneity)) +
  geom_point(alpha=0.2) +
  stat_summary(fun = mean, geom = "point", shape = 21, size = 3, fill = "red", color = "black") +
      stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = 0.2) +
coord_flip() +
  labs(
    x = NULL,
    y = "homogeneity",
    title = "homogeneity by Voting Intention"
  ) +
  theme_minimal()
```

```{r}
pilot2 %>%
  drop_na(coalition_party_vote_intention) %>% 
  ggplot(aes(x = homogeneity, fill = coalition_party_vote_intention %>% labelled::to_factor())) +
  geom_bar(position=position_dodge()) +
  theme_minimal()
```

#### Popular suvrenity

```{r}
pilot2 %>%
      filter(party_vote_intention!=9) %>% 
mutate(
    party_vote_intention = labelled::to_factor(party_vote_intention)
  ) %>%
  group_by(party_vote_intention) %>%
  mutate(mean_pop = mean(popular_sovereignty, na.rm = TRUE)) %>%
  ungroup() %>%
  mutate(party_vote_intention = fct_reorder(party_vote_intention, mean_pop)) %>%
  ggplot(aes(x = party_vote_intention, y = popular_sovereignty)) +
  geom_point(alpha=0.2) +
  stat_summary(fun = mean, geom = "point", shape = 21, size = 3, fill = "red", color = "black") +
      stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = 0.2) +
coord_flip() +
  labs(
    x = NULL,
    y = "popular_sovereignty",
    title = "popular_sovereignty by Voting Intention"
  ) +
  theme_minimal()
```

```{r}
pilot2 %>%
  drop_na(coalition_party_vote_intention) %>% 
  ggplot(aes(x = popular_sovereignty, fill = coalition_party_vote_intention %>% labelled::to_factor())) +
  geom_bar(position=position_dodge()) +
  theme_minimal()
```






```{r}
pilot2 %>%
      dplyr::select(populist_attitudes_index_4dim,
      anti_elitism,
      homogeneity,
      popular_sovereignty,
      manichean,
      coalition_party_vote_intention) %>%
        gtsummary::tbl_summary(statistic = list(all_continuous() ~ "{mean} ({sd})"),by=coalition_party_vote_intention)
```

### Correlations with other variables

```{r}
pilot2 %>%
  drop_na(education) %>% 
  ggplot(aes(x = education %>% labelled::to_factor(), y = populist_attitudes_index_4dim)) +
  geom_point(alpha=0.2) +
  stat_summary(fun = mean, geom = "point", shape = 21, size = 3, fill = "red", color = "black") +
      stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = 0.2) +
coord_flip() +
  labs(
    x = NULL,
    y = "Populist Attitudes index",
    title = "Populist Attitudes by education"
  ) +
  theme_minimal()
```

```{r}
pilot2 %>%
  drop_na(income) %>% 
  ggplot(aes(x = income %>% labelled::to_factor(), y = populist_attitudes_index_4dim)) +
  geom_point(alpha=0.2) +
  stat_summary(fun = mean, geom = "point", shape = 21, size = 3, fill = "red", color = "black") +
      stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = 0.2) +
coord_flip() +
  labs(
    x = NULL,
    y = "Populist Attitudes index",
    title = "Populist Attitudes by income"
  ) +
  theme_minimal()
```

```{r}
pilot2 %>%
  drop_na(religiosity) %>% 
  ggplot(aes(x = religiosity %>% labelled::to_factor(), y = populist_attitudes_index_4dim)) +
  geom_boxplot() +
  stat_summary(fun = mean, geom = "point", shape = 21, size = 3, fill = "red", color = "black") +
      stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = 0.2) +
coord_flip() +
  labs(
    x = NULL,
    y = "Populist Attitudes index",
    title = "Populist Attitudes by religiosity"
  ) +
  theme_minimal()
```

```{r}
pilot2 %>%
  drop_na(ethnic_identity) %>% 
  ggplot(aes(x = ethnic_identity %>% labelled::to_factor(), y = populist_attitudes_index_4dim)) +
  geom_point(alpha=0.2) +
  stat_summary(fun = mean, geom = "point", shape = 21, size = 3, fill = "red", color = "black") +
      stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = 0.2) +
coord_flip() +
  labs(
    x = NULL,
    y = "Populist Attitudes index",
    title = "Populist Attitudes by ethnic_identity"
  ) +
  theme_minimal()
```

```{r}
pilot2 %>%
  drop_na(public_sector_employee_current, populist_attitudes_index_4dim) %>%
  mutate(public_sector_employee_current = labelled::to_factor(public_sector_employee_current)) %>%
  ggplot(aes(x = populist_attitudes_index_4dim, fill = public_sector_employee_current)) +
  geom_histogram(position = "identity", alpha = 0.5, bins = 30, color = "black") +
  labs(
    x = "Populist Attitudes Index",
    y = "Count",
    title = "Distribution of Populist Attitudes by public_sector_employee_current"
  ) +
  theme_minimal()
```

```{r}
pilot2 %>%
  drop_na(gender, populist_attitudes_index_4dim) %>%
  mutate(gender = labelled::to_factor(gender)) %>%
  ggplot(aes(x = populist_attitudes_index_4dim, fill = gender)) +
  geom_histogram(position = "identity", alpha = 0.5, bins = 30, color = "black") +
  labs(
    x = "Populist Attitudes Index",
    y = "Count",
    title = "Distribution of Populist Attitudes by Gender"
  ) +
  theme_minimal()
```

```{r}
pilot2 %>%
  drop_na(affect_right) %>% 
  ggplot(aes(x = affect_right %>% labelled::to_factor(), y = populist_attitudes_index_3dim)) +
  geom_boxplot() +
  stat_summary(fun = mean, geom = "point", shape = 21, size = 3, fill = "red", color = "black") +
      stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = 0.2) +
coord_flip() +
  labs(
    x = NULL,
    y = "Populist Attitudes index",
    title = "Populist Attitudes by affect_right"
  ) +
  theme_minimal()
```

```{r}
pilot %>%
  drop_na(affect_left) %>% 
  ggplot(aes(x = affect_left %>% labelled::to_factor(), y = populist_attitudes_index_4dim)) +
  geom_boxplot() +
  stat_summary(fun = mean, geom = "point", shape = 21, size = 3, fill = "red", color = "black") +
      stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = 0.2) +
coord_flip() +
  labs(
    x = NULL,
    y = "Populist Attitudes index",
    title = "Populist Attitudes by affect_left"
  ) +
  theme_minimal()
```

```{r}
t1 <- pilot2 %>% 
  mutate(affective_delta = abs(affect_right-affect_left)) 
```

```{r}
hist(t1$affective_delta)
```

```{r}
pilot2 %>%
  drop_na(delta) %>% 
  ggplot(aes(x = affective_delta %>% labelled::to_factor(), y = populist_attitudes_index_3dim)) +
  geom_jitter() +
  stat_summary(fun = mean, geom = "point", shape = 21, size = 3, fill = "red", color = "black") +
      stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = 0.2) +
coord_flip() +
  labs(
    x = NULL,
    y = "Populist Attitudes index",
    title = "Populist Attitudes by abs (affect_right - affect_left)"
  ) +
  theme_minimal()
```



```{r}
t1 %>% labelled::remove_labels() %>% 
  drop_na(affective_delta) %>% 
  ggplot(aes(x = affective_delta %>% labelled::to_factor(), y = populist_attitudes_index_3dim)) +
  geom_jitter(aes(color=factor(political_block))) +
  stat_summary(fun = mean, geom = "point", shape = 21, size = 3, fill = "red", color = "black") +
      stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = 0.2) +
coord_flip() +
  labs(
    x = NULL,
    y = "Populist Attitudes index",
    title = "Populist Attitudes by abs (affect_right - affect_left)"
  ) +
  theme_minimal()
```

```{r}
pilot2 %>% 
  dplyr::select(populist_attitudes_index_4dim,
                populist_attitudes_index_3dim,
                populist_attitudes_index_4dim_minimum,
                populist_attitudes_index_4dim_multiplication,
                popular_sovereignty:manichean,
                female,
                age_group,
                income,
                subjective_social_economic_status,
                education,
                religiosity,
                right_left_ideology,
                external_efficecy,
                affect_right,
                affect_left,
                affective_polarization) %>% labelled::remove_labels() %>% 
  sjPlot::tab_corr(triangle = "lower",
  show.p = TRUE,
  p.numeric = TRUE)
```

```{r}
model_1 <- lm(populist_attitudes_index_4dim ~ coalition_party_vote_intention + 
  female +
                age_group+
                income+
                education+
                right_left_ideology+
                external_efficecy+
                subjective_social_economic_status +
                affective_polarization,pilot2 %>% labelled::remove_labels(),na.rm=T)

model_2 <- model_1 %>% update(popular_sovereignty~.)
model_3 <- model_1 %>% update(anti_elitism~.)
model_4 <- model_1 %>% update(homogeneity~.)
model_5 <- model_1 %>% update(manichean~.)


sjPlot::tab_model(model_1,model_2,model_3,model_4,model_5,
                  show.est = F,
                  show.std = T,
                  collapse.ci = T)
```

# Trust

```{r}
pilot2 %>% labelled::remove_labels() %>% 
  dplyr::select(trust_knesset:trust_media,coalition_party_vote_intention) %>% 
  gtsummary::tbl_summary(
statistic = list(by="coalition_party_vote_intention")
```

```{r}

pilot2 %>% labelled::remove_labels() |> 
  group_by(coalition_party_vote_intention) |>
  summarise(
    across(trust_knesset:trust_media, ~mean(.x, na.rm=TRUE))
  )
```

```{r}
pilot2 %>% labelled::remove_labels() %>% 
  dplyr::select(trust_knesset:trust_media) %>% 
  sjPlot::tab_itemscale()
```

```{r}
pilot2 %>% labelled::remove_labels() %>% 
  dplyr::select(populist_attitudes_index_4dim,        
trust_knesset:trust_media) %>% 
  sjPlot::tab_corr(triangle = "lower", title = "Correlation Table: Stereotype Items")
```

```{r}
t1 <- pilot2 %>% 
  mutate(trust_index = (trust_knesset+
           trust_government+
           trust_judiciary+
           trust_health+
           trust_police+
           trust_municipality+
           trust_civil_service+
           trust_media)/8)


t1 %>% 
  dplyr::select(populist_attitudes_index_3dim,trust_index) %>% 
  sjPlot::tab_corr()
```

```{r}
pilot2 %>% labelled::remove_labels() |> 
  dplyr::select(populist_attitudes_index_4dim,trust_knesset,
           trust_government,
           trust_judiciary,
           trust_health,
           trust_police,
           trust_municipality,
           trust_civil_service,
           trust_media,
           external_efficecy) |> 
  sjPlot::tab_corr()
```

```{r}
pilot2 %>%
  mutate(
    trust_government = labelled::to_factor(trust_government)
  ) %>%
  ggplot(aes(x = trust_government, y = populist_attitudes_index_3dim)) +
  geom_point(alpha=0.2) +
  stat_summary(fun = mean, geom = "point", shape = 21, size = 3, fill = "red", color = "black") +
    stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = 0.2) +
coord_flip() +
  labs(
    x = NULL,
    y = "Populist Attitudes Index",
    title = "Populist Attitudes by trust in government"
  ) +
  theme_minimal()
```

```{r}
pilot2 %>%
  mutate(
    trust_government = labelled::to_factor(trust_government)
  ) %>%
  ggplot(aes(x = trust_government, y = populist_attitudes_index_3dim)) +
  geom_point(alpha=0.2) +
  stat_summary(fun = mean, geom = "point", shape = 21, size = 3, fill = "red", color = "black") +
    stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = 0.2) +
coord_flip() +
  labs(
    x = NULL,
    y = "Populist Attitudes Index",
    title = "Populist Attitudes by Past Vote"
  ) +
    facet_wrap(vars(coalition_party_vote_intention))+
  theme_minimal()
```

```{r}
tmod1 <- lm(trust_government ~ populist_attitudes_index_3dim, data=pilot2 %>% labelled::remove_labels())
tmod2 <- tmod1 %>% update(.~.+ coalition_party_vote_intention)
tmod3 <- tmod1 %>% update(.~.,data=pilot2 %>% labelled::remove_labels() %>% filter(coalition_party_vote_intention=="Netanyahu coalition"))
tmod4 <- tmod1 %>% update(.~.,data=pilot2 %>% labelled::remove_labels() %>% filter(coalition_party_vote_intention=="Anti Netanyahu coalition"))
tmod5 <- tmod1 %>% update(.~.+ populist_attitudes_index_3dim*coalition_party_vote_intention)


sjPlot::tab_model(tmod1,tmod2,tmod3,tmod4,tmod5,
                  show.est = F,
                  show.std = T,
                  collapse.ci = T)
```

```{r}
sjPlot::plot_model(tmod5,type = "pred",terms = c("populist_attitudes_index_3dim", "coalition_party_vote_intention"))
```

```{r}
tmod1 <- lm(populist_attitudes_index_3dim ~ trust_knesset, data=pilot2 %>% labelled::remove_labels())
tmod2 <- tmod1 %>% update(.~.,data=pilot2 %>% labelled::remove_labels() %>% filter(coalition_party_vote_intention=="Netanyahu coalition"))
tmod3 <- tmod1 %>% update(.~.,data=pilot2 %>% labelled::remove_labels() %>% filter(coalition_party_vote_intention=="Anti Netanyahu coalition"))


sjPlot::tab_model(tmod1,tmod2,tmod3,
                  show.est = F,
                  show.std = T,
                  collapse.ci = T)
```

```{r}
tmod1 <- lm(trust_civil_service ~ populist_attitudes_index_3dim, data=pilot2 %>% labelled::remove_labels())
tmod2 <- tmod1 %>% update(.~.+ coalition_party_vote_intention)
tmod3 <- tmod1 %>% update(.~.,data=pilot2 %>% labelled::remove_labels() %>% filter(coalition_party_vote_intention=="Netanyahu coalition"))
tmod4 <- tmod1 %>% update(.~.,data=pilot2 %>% labelled::remove_labels() %>% filter(coalition_party_vote_intention=="Anti Netanyahu coalition"))
tmod5 <- tmod1 %>% update(.~.+ populist_attitudes_index_3dim*coalition_party_vote_intention)


sjPlot::tab_model(tmod1,tmod2,tmod3,tmod4,tmod5,
                  show.est = F,
                  show.std = T,
                  collapse.ci = T)
```

```{r}
sjPlot::plot_model(tmod5,type = "pred",terms = c("populist_attitudes_index_3dim", "coalition_party_vote_intention"))
```


Correlations between trust and populist attitudes across partisanship
```{r}
pilot2 %>% labelled::remove_labels() %>% 
  dplyr::select(populist_attitudes_index_3dim,                popular_sovereignty:manichean,
trust_knesset:trust_media) %>% 
  sjPlot::tab_corr(triangle = "lower",
  title = "All respondents")
```

```{r}
pilot2 %>% filter(coalition_party_vote_intention=="Netanyahu coalition") %>% labelled::remove_labels() %>%
  dplyr::select(populist_attitudes_index_3dim,                popular_sovereignty:manichean,
trust_knesset:trust_media) %>% 
  sjPlot::tab_corr(triangle = "lower",
  title = "Netanyahu coalition")
```

```{r}
pilot2 %>% filter(coalition_party_vote_intention=="Anti Netanyahu coalition") %>% labelled::remove_labels() %>%
  dplyr::select(populist_attitudes_index_3dim,                popular_sovereignty:manichean,
trust_knesset:trust_media) %>% 
  sjPlot::tab_corr(triangle = "lower",
  title = "Anti Netanyahu coalition")
```



```{r}
##ggplot2 histogram of trust in civil service

pilot2 |> 
  labelled::remove_labels() |> 
  ggplot(aes(x = trust_civil_service)) +
  geom_histogram(binwidth = 1, fill = "blue", color = "black", alpha = 0.7) +
  labs(
    title = "Distribution of Trust in Civil Service",
    x = "Trust in Civil Service Score",
    y = "Count"
  ) +
  theme_minimal()

```


```{r}
##ggplot2 histogram of trust in civil service

pilot2 |> 
  labelled::remove_labels() |> 
  ggplot(aes(x = trust_civil_service)) +
  geom_histogram(binwidth = 1, fill = "blue", color = "black", alpha = 0.7) +
  facet_wrap(vars(coalition_party_vote_intention))+
  labs(
    title = "Distribution of Trust in Civil Service",
    x = "Trust in Civil Service Score",
    y = "Count"
  ) +
  theme_minimal()

```

```{r}
model_1 <- lm(trust_civil_service ~ populist_attitudes_index_4dim + coalition_party_vote_intention + right_left_ideology ,pilot2 %>% labelled::remove_labels()|> filter(coalition_party_vote_intention!="Other"),na.rm=T)

model_2 <- model_1 %>% update(.~.+populist_attitudes_index_4dim*(coalition_party_vote_intention))

model_3 <- model_1 %>% update(.~.+ 
  female +
                age_group+
                income+
                education+
                external_efficecy+
                subjective_social_economic_status +
                affective_polarization)
model_4 <- model_3 %>% update(.~.+populist_attitudes_index_4dim*(coalition_party_vote_intention))



sjPlot::tab_model(model_1,model_2,model_3,model_4,
                  show.est = F,
                  show.std = T,
                  collapse.ci = T)
```

```{r}
sjPlot::plot_model(model_4,type = "pred",terms = c("populist_attitudes_index_4dim", "coalition_party_vote_intention"))
```




```{r}
##ggplot2 histogram of trust in police

pilot2 |> 
  labelled::remove_labels() |> 
  ggplot(aes(x = trust_police)) +
  geom_histogram(binwidth = 1, fill = "blue", color = "black", alpha = 0.7) +
  facet_wrap(vars(coalition_party_vote_intention))+
  labs(
    title = "Distribution of Trust in Civil Service",
    x = "Trust in Civil Service Score",
    y = "Count"
  ) +
  theme_minimal()

```

```{r}
model_1 <- lm(trust_police ~ populist_attitudes_index_4dim + coalition_party_vote_intention + right_left_ideology ,pilot2 %>% labelled::remove_labels(),na.rm=T)

model_2 <- model_1 %>% update(.~.+populist_attitudes_index_4dim*(coalition_party_vote_intention))

model_3 <- model_1 %>% update(.~.+ 
  female +
                age_group+
                income+
                education+
                external_efficecy+
                subjective_social_economic_status +
                affective_polarization)
model_4 <- model_3 %>% update(.~.+populist_attitudes_index_4dim*(coalition_party_vote_intention))
model_5 <- lm(trust_police ~ populist_attitudes_index_4dim + right_left_ideology ,pilot2 %>% labelled::remove_labels() |> filter(coalition_party_vote_intention=="Netanyahu coalition"))


sjPlot::tab_model(model_1,model_2,model_3,model_4,model_5,
                  show.est = F,
                  show.std = T,
                  collapse.ci = T)
```

```{r}
sjPlot::plot_model(model_4,type = "pred",terms = c("populist_attitudes_index_4dim", "coalition_party_vote_intention"))
```



```{r}
model_1 <- lm(trust_police ~ anti_elitism + coalition_party_vote_intention + right_left_ideology ,pilot2 %>% labelled::remove_labels(),na.rm=T)

model_2 <- model_1 %>% update(.~.+anti_elitism*(coalition_party_vote_intention+right_left_ideology))

model_3 <- model_1 %>% update(.~.+ 
  female +
                age_group+
                income+
                education+
                external_efficecy+
                subjective_social_economic_status +
                affective_polarization)
model_4 <- model_3 %>% update(.~.+anti_elitism*(coalition_party_vote_intention+right_left_ideology))



sjPlot::tab_model(model_1,model_2,model_3,model_4,
                  show.est = F,
                  show.std = T,
                  collapse.ci = T)
```

```{r}
sjPlot::plot_model(model_4,type = "pred",terms = c("anti_elitism", "coalition_party_vote_intention"))
```



```{r}
model_1 <- lm(trust_judiciary ~ populist_attitudes_index_4dim + coalition_party_vote_intention + right_left_ideology ,pilot2 %>% labelled::remove_labels()|> filter(coalition_party_vote_intention!="Other"),na.rm=T)

model_2 <- model_1 %>% update(.~.+populist_attitudes_index_4dim*(coalition_party_vote_intention))

model_3 <- model_1 %>% update(.~.+ 
  female +
                age_group+
                income+
                education+
                external_efficecy+
                subjective_social_economic_status +
                affective_polarization)
model_4 <- model_3 %>% update(.~.+populist_attitudes_index_4dim*(coalition_party_vote_intention))



sjPlot::tab_model(model_1,model_2,model_3,model_4,
                  show.est = F,
                  show.std = T,
                  collapse.ci = T)
```

```{r}
sjPlot::plot_model(model_4,type = "pred",terms = c("populist_attitudes_index_4dim", "coalition_party_vote_intention"))
```


```{r}
model_1 <- lm(trust_media ~ populist_attitudes_index_4dim + coalition_party_vote_intention + right_left_ideology ,pilot2 %>% labelled::remove_labels()|> filter(coalition_party_vote_intention!="Other"),na.rm=T)

model_2 <- model_1 %>% update(.~.+populist_attitudes_index_4dim*(coalition_party_vote_intention))

model_3 <- model_1 %>% update(.~.+ 
  female +
                age_group+
                income+
                education+
                external_efficecy+
                subjective_social_economic_status +
                affective_polarization)
model_4 <- model_3 %>% update(.~.+populist_attitudes_index_4dim*(coalition_party_vote_intention))



sjPlot::tab_model(model_1,model_2,model_3,model_4,
                  show.est = F,
                  show.std = T,
                  collapse.ci = T)
```

```{r}
sjPlot::plot_model(model_4,type = "pred",terms = c("populist_attitudes_index_4dim", "coalition_party_vote_intention"))
```


```{r}
model_1 <- lm(trust_health ~ populist_attitudes_index_4dim + coalition_party_vote_intention + right_left_ideology ,pilot2 %>% labelled::remove_labels()|> filter(coalition_party_vote_intention!="Other"),na.rm=T)

model_2 <- model_1 %>% update(.~.+populist_attitudes_index_4dim*(coalition_party_vote_intention+right_left_ideology))

model_3 <- model_1 %>% update(.~.+ 
  female +
                age_group+
                income+
                education+
                external_efficecy+
                subjective_social_economic_status +
                affective_polarization)
model_4 <- model_3 %>% update(.~.+populist_attitudes_index_4dim*(coalition_party_vote_intention+right_left_ideology))



sjPlot::tab_model(model_1,model_2,model_3,model_4,
                  show.est = F,
                  show.std = T,
                  collapse.ci = T)
```

```{r}
sjPlot::plot_model(model_4,type = "pred",terms = c("populist_attitudes_index_4dim", "coalition_party_vote_intention"))
```



```{r}
model_1 <- lm(trust_police ~ populist_attitudes_index_4dim + coalition_party_vote_intention + right_left_ideology ,pilot2 %>% labelled::remove_labels()|> filter(coalition_party_vote_intention!="Other"),na.rm=T)

model_2 <- model_1 %>% update(.~.+populist_attitudes_index_4dim*(coalition_party_vote_intention+right_left_ideology))

model_3 <- model_1 %>% update(.~.+ 
  female +
                age_group+
                income+
                education+
                external_efficecy+
                subjective_social_economic_status +
                affective_polarization)
model_4 <- model_3 %>% update(.~.+populist_attitudes_index_4dim*(coalition_party_vote_intention+right_left_ideology))



sjPlot::tab_model(model_1,model_2,model_3,model_4,
                  show.est = F,
                  show.std = T,
                  collapse.ci = T)
```

```{r}
sjPlot::plot_model(model_4,type = "pred",terms = c("populist_attitudes_index_4dim", "coalition_party_vote_intention"))
```



```{r}
model_1 <- lm(trust_knesset ~ populist_attitudes_index_4dim + coalition_party_vote_intention + right_left_ideology ,pilot2 %>% labelled::remove_labels()|> filter(coalition_party_vote_intention!="Other"),na.rm=T)

model_2 <- model_1 %>% update(.~.+populist_attitudes_index_4dim*(coalition_party_vote_intention+right_left_ideology))

model_3 <- model_1 %>% update(.~.+ 
  female +
                age_group+
                income+
                education+
                external_efficecy+
                subjective_social_economic_status +
                affective_polarization)
model_4 <- model_3 %>% update(.~.+populist_attitudes_index_4dim*(coalition_party_vote_intention+right_left_ideology))



sjPlot::tab_model(model_1,model_2,model_3,model_4,
                  show.est = F,
                  show.std = T,
                  collapse.ci = T)
```

```{r}
sjPlot::plot_model(model_4,type = "pred",terms = c("populist_attitudes_index_4dim", "coalition_party_vote_intention"))
```

# Conspiracy

```{r}
##ggplot2 histogram of conspiracy beliefs

pilot2 |> 
  labelled::remove_labels() |> 
  ggplot(aes(x = conspiracy_deep_state_n)) +
  geom_histogram(binwidth = 1, fill = "blue", color = "black", alpha = 0.7) +
  labs(
    title = "Distribution of Deep State Conspiracy Beliefs",
    x = "Deep State Conspiracy Belief Score",
    y = "Count"
  ) +
  theme_minimal()

```


```{r}
pilot2 %>%
  drop_na(party_vote_intention) %>% 
  ggplot(aes(x = party_vote_intention %>% labelled::to_factor(), y = conspiracy_deep_state_n)) +
  stat_summary(fun = mean, geom = "point", shape = 21, size = 3, fill = "red", color = "black") +
      stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = 0.2) +
coord_flip() +
labs(x = NULL,
    y = "Deep State Conspiracy Belief Score",
    title = "Deep State Conspiracy Beliefs by Voting Intention"
  ) +
  theme_minimal()
```

```{r}
pilot2 %>%
  drop_na(coalition_party_vote_intention) %>% 
  ggplot(aes(x = coalition_party_vote_intention %>% labelled::to_factor(), y = conspiracy_deep_state_n)) +
  stat_summary(fun = mean, geom = "point", shape = 21, size = 3, fill = "red", color = "black") +
      stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = 0.2) +
coord_flip() +
labs(x = NULL,
    y = "Deep State Conspiracy Belief Score",
    title = "Deep State Conspiracy Beliefs by Voting Intention coalition"
  ) +
  theme_minimal()
```

```{r}
pilot2 %>% labelled::remove_labels() %>% 
  dplyr::select(populist_attitudes_index_4dim,                popular_sovereignty:manichean,
conspiracy_deep_state_n,conspiracy_vaccine_n) %>% 
  sjPlot::tab_corr(triangle = "lower")

pilot2 %>% labelled::remove_labels() %>% 
  dplyr::select(populist_attitudes_index_4dim,    
conspiracy_deep_state_n,conspiracy_vaccine_n) %>% 
  sjPlot::tab_corr(triangle = "lower")

```

```{r}
pilot2 %>% labelled::remove_labels() %>% 
  dplyr::select(populist_attitudes_index_4dim,                popular_sovereignty:manichean,
conspiracy_deep_state_n,conspiracy_vaccine_n,
trust_knesset:trust_media) %>% 
  sjPlot::tab_corr(triangle = "lower")

```


Correlations between trust and populist attitudes across partisanship
```{r}
pilot2 %>%
  labelled::remove_labels() %>%
  dplyr::select(
    populist_attitudes_index_4dim,populist_attitudes_index_4dim_minimum, 
        popular_sovereignty:manichean,
    conspiracy_deep_state_n,
    conspiracy_vaccine_n,
    trust_knesset:trust_media
  ) %>%
  sjPlot::tab_corr(triangle = "lower", title = "All respondents")
```

```{r}
pilot2 %>%
  filter(coalition_party_vote_intention == "Netanyahu coalition") %>%
  labelled::remove_labels() %>%
  dplyr::select(
    populist_attitudes_index_4dim,populist_attitudes_index_4dim,populist_attitudes_index_4dim_minimum, 
        popular_sovereignty:manichean,
    conspiracy_deep_state_n,
    conspiracy_vaccine_n,
    trust_knesset:trust_media
  ) %>%
  sjPlot::tab_corr(triangle = "lower", title = "Netanyahu coalition",p.numeric=TRUE)
```

```{r}
pilot2 %>%
  filter(coalition_party_vote_intention == "Anti Netanyahu coalition") %>%
  labelled::remove_labels() %>%
  dplyr::select(
    populist_attitudes_index_4dim,populist_attitudes_index_4dim,populist_attitudes_index_4dim_minimum, 
        popular_sovereignty:manichean,
    conspiracy_deep_state_n,
    conspiracy_vaccine_n,
    trust_knesset:trust_media
  ) %>%
  sjPlot::tab_corr(triangle = "lower", title = "Anti Netanyahu coalition",p.numeric=TRUE)
```

Models for deep state conspiracy belief


```{r}
model_1 <- lm(conspiracy_deep_state_n ~ populist_attitudes_index_4dim + coalition_party_vote_intention + right_left_ideology ,pilot2 %>% labelled::remove_labels()|> filter(coalition_party_vote_intention!="Other"),na.rm=T)

model_2 <- model_1 %>% update(conspiracy_deep_state_n~.+populist_attitudes_index_4dim*(coalition_party_vote_intention))

model_3 <- model_1 %>% update(.~.+ 
  female +
                age_group+
                income+
                education+
                external_efficecy+
                subjective_social_economic_status +
                affective_polarization)
model_4 <- model_3 %>% update(conspiracy_deep_state_n~.+populist_attitudes_index_4dim*(coalition_party_vote_intention))



sjPlot::tab_model(model_1,model_2,model_3,model_4,
                  show.est = F,
                  show.std = T,
                  collapse.ci = T)
```

```{r}
sjPlot::plot_model(model_4,type = "pred",terms = c("populist_attitudes_index_4dim", "coalition_party_vote_intention"))
```

Models for vaccine conspiracy belief


```{r}
model_1 <- lm(conspiracy_vaccine_n ~ populist_attitudes_index_4dim + coalition_party_vote_intention + right_left_ideology ,pilot2 %>% labelled::remove_labels()|> filter(coalition_party_vote_intention!="Other"),na.rm=T)

model_2 <- model_1 %>% update(.~.+populist_attitudes_index_4dim*(coalition_party_vote_intention))

model_3 <- model_1 %>% update(.~.+ 
  female +
                age_group+
                income+
                education+
                external_efficecy+
                subjective_social_economic_status +
                affective_polarization)
model_4 <- model_3 %>% update(.~.+populist_attitudes_index_4dim*(coalition_party_vote_intention))



sjPlot::tab_model(model_1,model_2,model_3,model_4,
                  show.est = F,
                  show.std = T,
                  collapse.ci = T)
```
```{r}
sjPlot::plot_model(model_4,type = "pred",terms = c("populist_attitudes_index_4dim", "coalition_party_vote_intention"))
```


# Dimensions

```{r}
coded_responses_pilot2 <- read_csv("data/coded_responses_P2_merged.csv")

responses_pilot2 <- coded_responses_pilot2 %>% 
  filter(`erase?`!=1) %>% 
  left_join(pilot2,by=c("civil_servant_label","response_id"))
```

```{r}
responses_pilot2 %>% 
  mutate(response_direction = as.numeric(response_direction)) %>% 
  dplyr::select(civil_servant_label,
                response_direction,
                assertiveness:other) %>% 
  gtsummary::tbl_summary(by=civil_servant_label)

```

```{r}
#distribution of direction responses by coalition party vote intention

responses_pilot2 %>% 
  drop_na(coalition_party_vote_intention) %>%
  ggplot(aes(x=response_direction,fill=coalition_party_vote_intention))+
  geom_bar(position = "dodge")+
  labs(title="All responses by coalition party vote intention")


```


Civil servants

```{r}
responses_pilot2 %>% 
  filter(civil_servant_label=="public service employee") %>% 
  ggplot(aes(x=response_direction))+
  geom_bar()+
  labs(title="All responses")

responses_pilot2 %>% 
  filter(civil_servant_label=="public service employee",
         sociability==1) %>% 
  ggplot(aes(x=response_direction))+
  geom_bar()+
  labs(title="Sociability")

responses_pilot2 %>% 
  filter(civil_servant_label=="public service employee",
         morality==1) %>% 
  ggplot(aes(x=response_direction))+
  geom_bar()+
  labs(title="Morality")


responses_pilot2 %>% 
  filter(civil_servant_label=="public service employee",
         ability==1) %>% 
  ggplot(aes(x=response_direction))+
  geom_bar()+
  labs(title="Ability")


responses_pilot2 %>% 
  filter(civil_servant_label=="public service employee",
         assertiveness==1) %>% 
  ggplot(aes(x=response_direction))+
  geom_bar()+
  labs(title="Assertiveness")


```

```{r}
responses_pilot2 %>% 
  drop_na(civil_servant_label) %>%
#filter(civil_servant_label!="public service bureaucrat") %>% 
  ggplot(aes(x=populist_attitudes_index_4dim,y=response_direction))+
  geom_point()+
  geom_smooth(method="lm")+
  facet_wrap(vars(civil_servant_label))+
  theme_blank()
  
```

```{r}
responses_pilot2 %>% 
  drop_na(civil_servant_label) %>%
#filter(civil_servant_label!="public service bureaucrat") %>% 
  ggplot(aes(x=populist_attitudes_index_4dim,y=response_direction,color=coalition_party_vote_intention))+
  geom_jitter(alpha=0.6)+
  facet_wrap(vars(civil_servant_label))+
  geom_smooth(method="lm")+
  theme_blank()
  
```

Only coalition
```{r}
responses_pilot2 %>% 
  drop_na(civil_servant_label) %>%
  filter(coalition_party_vote_intention=="Netanyahu coalition") %>%
#filter(civil_servant_label!="public service bureaucrat") %>% 
  ggplot(aes(x=populist_attitudes_index_4dim,y=response_direction))+
  geom_point()+
  geom_smooth(method="lm")+
  #facet_wrap(vars(civil_servant_label))+
   labs(title="Only coalition party voters")+
  theme_blank()
  
```


Only opposition
```{r}
responses_pilot2 %>% 
  drop_na(civil_servant_label) %>%
  filter(coalition_party_vote_intention=="Anti Netanyahu coalition") %>%
#filter(civil_servant_label!="public service bureaucrat") %>% 
  ggplot(aes(x=populist_attitudes_index_4dim,y=response_direction))+
  geom_point()+
  geom_smooth(method="lm")+
  #facet_wrap(vars(civil_servant_label))+
   labs(title="Only Anti netanyahu coalition party voters")+
  theme_blank()
  
```


```{r}
# regression model for direction by populist attitudes index and civil servant type
tmod1 <- lme4::lmer(
  response_direction ~ populist_attitudes_index_4dim +
    coalition_party_vote_intention +
    civil_servant_label +
    (1 | pid.x),
  data = responses_pilot2 %>% labelled::remove_labels()
)
tmod2 <- tmod1 %>%
  update(. ~ . + populist_attitudes_index_4dim * coalition_party_vote_intention)
tmod3 <- tmod2 %>%
  update(
    . ~ . +
      female +
      age_group +
      income +
      education +
      external_efficecy +
      subjective_social_economic_status +
      affective_polarization
  )

sjPlot::tab_model(tmod1, tmod2,  show.est = F, show.std = T, collapse.ci = T)
```




By dimension

Morality
```{r}
responses_pilot2 %>% 
  drop_na(civil_servant_label) %>%
  filter(morality==1) %>%
#filter(civil_servant_label!="public service bureaucrat") %>% 
  ggplot(aes(x=populist_attitudes_index_4dim_minimum,y=response_direction,color=coalition_party_vote_intention))+
  geom_point()+
  geom_smooth(method="lm")+
  #facet_wrap(vars(civil_servant_label))+
  labs(title="Morality - All")+
  theme_blank()
  
```

```{r}
responses_pilot2 %>% 
  drop_na(civil_servant_label) %>%
  filter(morality==1,
  coalition_party_vote_intention=="Netanyahu coalition") %>%
#filter(civil_servant_label!="public service bureaucrat") %>% 
  ggplot(aes(x=populist_attitudes_index_4dim,y=response_direction))+
  geom_point()+
  geom_smooth(method="lm")+
  #facet_wrap(vars(civil_servant_label))+
    labs(title="Morality - Netanyahu coalition")+
  theme_blank()
  
```

```{r}
responses_pilot2 %>% 
  drop_na(civil_servant_label) %>%
  filter(ability==1,
  coalition_party_vote_intention=="Netanyahu coalition") %>%
#filter(civil_servant_label!="public service bureaucrat") %>% 
  ggplot(aes(x=populist_attitudes_index_4dim,y=response_direction))+
  geom_point()+
  geom_smooth(method="lm")+
  #facet_wrap(vars(civil_servant_label))+
    labs(title="Ability - Netanyahu coalition")+
  theme_blank()
  
```


```{r}
responses_pilot2 %>% 
  drop_na(civil_servant_label) %>%
  filter(morality==1,
  coalition_party_vote_intention=="Anti Netanyahu coalition") %>%
#filter(civil_servant_label!="public service bureaucrat") %>% 
  ggplot(aes(x=populist_attitudes_index_4dim,y=response_direction))+
  geom_point()+
  geom_smooth(method="lm")+
  #facet_wrap(vars(civil_servant_label))+
    labs(title="Morality - Anti Netanyahu coalition")+
  theme_blank()
  
```


```{r}
responses_pilot2 %>% 
  drop_na(civil_servant_label) %>%
  #filter(civil_servant_label!="public service bureaucrat") %>% 
  ggplot(aes(x=populist_attitudes_index_4dim,y=morality,color=coalition_party_vote_intention))+
  geom_point()+
  geom_smooth(method="lm")+
  #facet_wrap(vars(civil_servant_label))+
    labs(title="Morality")+
  theme_blank()
  
```





Civil servants

```{r}
tmod1 <- lme4::lmer(response_direction~populist_attitudes_index_3dim + (1|pid.x),data=responses %>% filter(entity=="civil servants") %>% labelled::remove_labels())
tmod2 <- tmod1 %>% update(.~.+
                            female +
                age_group+
                income+
                education+
                right_left_ideology+
                external_efficecy+
                subjective_social_economic_status)

sjPlot::tab_model(tmod1,tmod2,
                  show.est = F,
                  show.std = T,
                  collapse.ci = T)

```




Deep state conspiracy belief and response direction for civil servants

```{r}
responses_pilot2 %>% 
  drop_na(civil_servant_label) %>%
  filter(morality==1) |> 
  #coalition_party_vote_intention=="Netanyahu coalition") %>%
#filter(civil_servant_label!="public service bureaucrat") %>% 
  ggplot(aes(x=conspiracy_deep_state_n,y=response_direction,color=coalition_party_vote_intention))+
  geom_point()+
  geom_smooth(method="lm")+
  facet_wrap(vars(civil_servant_label))+
 #   labs(title="Morality - Netanyahu coalition")+
  theme_blank()
  


```



## Civil servants

```{r}
responses %>% 
  filter(entity=="civil servants") %>% 
  ggplot(aes(x=populist_attitudes_index_3dim,y=morality))+
  geom_point()+
  geom_smooth()+
  theme_blank()

responses %>% 
  filter(entity=="civil servants") %>% 
  ggplot(aes(x=populist_attitudes_index_3dim,y=ability))+
  geom_point()+
  geom_smooth()+
  theme_blank()


responses %>% 
  filter(entity=="civil servants") %>% 
  ggplot(aes(x=populist_attitudes_index_3dim,y=assertiveness))+
  geom_point()+
  geom_smooth()+
  theme_blank()

responses %>% 
  filter(entity=="civil servants") %>% 
  ggplot(aes(x=populist_attitudes_index_3dim,y=populi))+
  geom_point()+
  geom_smooth()+
  theme_blank()

```

```{r}
tmod1 <- lme4::glmer(morality~populist_attitudes_index_3dim + (1|pid.x),family="binomial" ,data=responses %>% filter(entity=="civil servants") %>% labelled::remove_labels())
tmod2 <- tmod1 %>% update(.~.+
                            female +
                age_group+
                income+
                education+
                right_left_ideology+
                external_efficecy+
                subjective_social_economic_status)

tmod3 <- tmod1 %>% update(ability~.)
tmod4 <- tmod2 %>% update(ability~.)

tmod5 <- tmod1 %>% update(assertiveness~.)
tmod6 <- tmod2 %>% update(assertiveness~.)


sjPlot::tab_model(tmod1,tmod2,
                  tmod3,tmod4,
                  tmod5,tmod6,
                  collapse.ci = T)
```

```{r}
responses %>% 
  filter(entity=="civil servants",morality==1) %>% 
  ggplot(aes(x=populist_attitudes_index_3dim,y=response_direction))+
  geom_point()+
  geom_smooth(method="lm")+
  theme_blank()+
  labs(title="Civil servants - Morality")

responses %>% 
  filter(entity=="civil servants",ability==1) %>% 
  ggplot(aes(x=populist_attitudes_index_3dim,y=response_direction))+
  geom_point()+
  geom_smooth(method="lm")+
  theme_blank()+
  labs(title="Civil servants - Ability")

responses %>% 
  filter(entity=="civil servants",assertiveness==1) %>% 
  ggplot(aes(x=populist_attitudes_index_3dim,y=response_direction))+
  geom_point()+
  geom_smooth(method="lm")+
  theme_blank()+
  labs(title="Civil servants - Assertiveness")

```

```{r}
tmod1 <- lme4::lmer(response_direction~populist_attitudes_index_3dim + (1|pid.x),data=responses %>% filter(entity=="civil servants",morality==1) %>% labelled::remove_labels())
tmod2 <- tmod1 %>% update(.~.+
                            female +
                age_group+
                income+
                education+
                right_left_ideology+
                external_efficecy+
                subjective_social_economic_status)

sjPlot::tab_model(tmod1,tmod2,
                  show.est = F,
                  show.std = T,
                  collapse.ci = T)
```


# Responses

## By dimension

Morality

```{r}
responses %>%
  filter(morality==1)%>%   
  group_by(response) %>% 
  summarise(n=n(),
            direction = mean(response_direction,na.rm=T) %>% round(1),
            populist_attitudes_index_3dim = mean(populist_attitudes_index_3dim,na.rm=T) %>% round(2)) %>% 
  filter(n>4) %>% 
  arrange(n %>% desc()) %>% 
  gt::gt()

```

```{r}
responses %>%
  filter(morality==1)%>%   
  group_by(`manual translation`) %>% 
  summarise(n=n(),
            direction = mean(response_direction,na.rm=T) %>% round(1)) %>% 
  filter(n>4) %>% 
  arrange(n %>% desc()) %>% 
  gt::gt()


```

Ability

```{r}
responses %>%
  filter(ability==1)%>%   
  group_by(response) %>% 
  summarise(n=n(),
            direction = mean(response_direction,na.rm=T) %>% round(1),
            populist_attitudes_index_3dim = mean(populist_attitudes_index_3dim,na.rm=T) %>% round(2)) %>% 
  filter(n>4) %>% 
  arrange(n %>% desc()) %>% 
  gt::gt()

```

```{r}
responses_pilot2 %>%
  filter(morality==1) %>%   
  group_by(response) %>% 
  summarise(n=n(),
            direction = mean(response_direction,na.rm=T) %>% round(1),
            populist_attitudes_index_3dim = mean(populist_attitudes_index_3dim,na.rm=T) %>% round(2)) %>% 
  #filter(n>4) %>% 
  arrange(n %>% desc()) %>% 
  gt::gt()

```

Assertiveness

```{r}
responses %>%
  filter(assertiveness==1)%>%   
  group_by(response) %>% 
  summarise(n=n(),
            direction = mean(response_direction,na.rm=T) %>% round(1),
            populist_attitudes_index_3dim = mean(populist_attitudes_index_3dim,na.rm=T) %>% round(2)) %>% 
  filter(n>4) %>% 
  arrange(n %>% desc()) %>% 
  gt::gt()

```

```{r}
responses %>%
  filter(entity=="senior civil servants")%>%   
  group_by(`manual translation`) %>% 
  summarise(n=n(),
            direction = mean(response_direction,na.rm=T) %>% round(1)) %>% 
  filter(n>4) %>% 
  arrange(n %>% desc()) %>% 
  gt::gt()


```

Status

```{r}
responses %>%
  filter(beliefs==1)%>%   
  group_by(response) %>% 
  summarise(n=n(),
            direction = mean(response_direction,na.rm=T) %>% round(1),
            populist_attitudes_index_3dim = mean(populist_attitudes_index_3dim,na.rm=T) %>% round(2)) %>% 
  filter(n>4) %>% 
  arrange(n %>% desc()) %>% 
  gt::gt()

```

## By entity

Civil servants

```{r}
responses %>%
  filter(entity=="civil servants")%>%   
  group_by(response) %>% 
  summarise(n=n(),
            direction = mean(response_direction,na.rm=T) %>% round(1),
            populist_attitudes_index_3dim = mean(populist_attitudes_index_3dim,na.rm=T) %>% round(2)) %>% 
  filter(n>2) %>% 
  arrange(n %>% desc()) %>% 
  gt::gt()

```

First response

```{r}
responses %>%
  filter(entity=="civil servants",response_order==1)%>%   
  group_by(response) %>% 
  summarise(n=n(),
            direction = mean(response_direction,na.rm=T) %>% round(1),
            populist_attitudes_index_3dim = mean(populist_attitudes_index_3dim,na.rm=T) %>% round(2)) %>% 
  filter(n>4) %>% 
  arrange(n %>% desc()) %>% 
  gt::gt()

```

Senior civil servants

```{r}
responses %>%
  filter(entity=="senior civil servants",response_order==1)%>%   
  group_by(response) %>% 
  summarise(n=n(),
            direction = mean(response_direction,na.rm=T) %>% round(1),
            populist_attitudes_index_3dim = mean(populist_attitudes_index_3dim,na.rm=T) %>% round(2)) %>% 
  filter(n>4) %>% 
  arrange(n %>% desc()) %>% 
  gt::gt()

```

# Prototype

```{r}
responses %>%
  filter(entity=="civil servants") %>%  
  distinct(pid.x,.keep_all = T) %>% 
  group_by(imagined_entity) %>% 
  summarise(n=n(),
            direction = mean(response_direction,na.rm=T) %>% round(1),
            populist_attitudes_index_3dim = mean(populist_attitudes_index_3dim,na.rm=T) %>% round(2)) %>% 
  arrange(n %>% desc()) %>% 
  gt::gt()

```

```{r}
entities <- responses %>% 
  dplyr::distinct(response_id,pid.x,entity,imagined_entity_code_detailed,imagined_entity) %>% left_join(pilot) %>% 
  mutate(imagined_entity_code_detailed = imagined_entity_code_detailed %>% as.factor() %>% 
           dplyr::recode('4'="4. Junior",
                         '5'="5. Senior",
                         '6'="6. Mixed",
                         '7'="7. Public service organization",
                         '8'="8. National level ministry",
                         '12'="12. Politician",
                         '13'="13. NA"))
```

```{r}
entities %>% 
  dplyr::select(entity,
                imagined_entity_code_detailed) %>% 
  tbl_summary(by=entity)
```

```{r}
entities %>%
  filter(entity=="civil servants") %>% 
  group_by(imagined_entity_code_detailed) %>%
  mutate(mean_pop = mean(populist_attitudes_index_3dim, na.rm = TRUE)) %>%
  ungroup() %>%
  ggplot(aes(x = imagined_entity_code_detailed, y = populist_attitudes_index_3dim)) +
  geom_point(alpha=0.2) +
  stat_summary(fun = mean, geom = "point", shape = 21, size = 3, fill = "red", color = "black") +
    stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = 0.2) +
coord_flip() +
  labs(
    x = NULL,
    y = "Populist Attitudes Index",
    title = "Populist Attitudes by imagined entity (civil servants)"
  ) +
  theme_minimal()
```

```{r}
responses %>%
  filter(entity=="junior civil servants") %>%  
  distinct(pid.x,.keep_all = T) %>% 
  group_by(imagined_entity) %>% 
  summarise(n=n(),
            direction = mean(response_direction,na.rm=T) %>% round(1),
            populist_attitudes_index_3dim = mean(populist_attitudes_index_3dim,na.rm=T) %>% round(2)) %>% 
  arrange(n %>% desc()) %>% 
  gt::gt()

```

```{r}
entities %>%
  filter(entity=="junior civil servants",
         !imagined_entity_code_detailed%in% c("1","2","3","9","8. National level ministry")) %>% 
  group_by(imagined_entity_code_detailed) %>%
  mutate(mean_pop = mean(populist_attitudes_index_3dim, na.rm = TRUE)) %>%
  ungroup() %>%
  ggplot(aes(x = imagined_entity_code_detailed, y = populist_attitudes_index_3dim)) +
  geom_point(alpha=0.2) +
  stat_summary(fun = mean, geom = "point", shape = 21, size = 3, fill = "red", color = "black") +
    stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = 0.2) +
coord_flip() +
  labs(
    x = NULL,
    y = "Populist Attitudes Index",
    title = "Populist Attitudes by imagined entity (junior civil servants)"
  ) +
  theme_minimal()
```

```{r}
responses_pilot2 %>%
  filter(coalition_party_vote_intention=="Netanyahu coalition") %>%  
  distinct(pid.x,.keep_all = T) %>% 
  group_by(imagined_entity) %>% 
  summarise(n=n(),
            direction = mean(response_direction,na.rm=T) %>% round(1),
            populist_attitudes_index_3dim = mean(populist_attitudes_index_3dim,na.rm=T) %>% round(2)) %>% 
  arrange(n %>% desc()) %>% 
  gt::gt()

```

```{r}
entities %>%
  filter(entity=="senior civil servants",
         !imagined_entity_code_detailed%in% c("1","9","7. Public service organization")) %>% 
  group_by(imagined_entity_code_detailed) %>%
  mutate(mean_pop = mean(populist_attitudes_index_3dim, na.rm = TRUE)) %>%
  ungroup() %>%
  ggplot(aes(x = imagined_entity_code_detailed, y = populist_attitudes_index_3dim)) +
  geom_point(alpha=0.2) +
  stat_summary(fun = mean, geom = "point", shape = 21, size = 3, fill = "red", color = "black") +
    stat_summary(fun.data = mean_cl_normal, geom = "errorbar", width = 0.2) +
coord_flip() +
  labs(
    x = NULL,
    y = "Populist Attitudes Index",
    title = "Populist Attitudes by imagined entity (senior civil servants)"
  ) +
  theme_minimal()
```

```{r}
responses %>% 
  filter(entity=="civil servants") %>% 
  dplyr::select(imagined_entity,
                response,
                response_direction,
                populist_attitudes_index_3dim) %>% 
  arrange(populist_attitudes_index_3dim %>% desc())
```

```{r}

p1 <- responses_pilot2 %>% 
  filter(coalition_party_vote_intention=="Netanyahu coalition") %>%
  ggplot(aes(x=populist_attitudes_index_4dim,y=response_direction))+
  geom_text(aes(label = response,color=morality |> as_factor()),size=1.5,position = position_jitter())+
  geom_smooth(method="lm")+
  labs(title="Only coalition party voters")+
  theme_classic()

p1 

ggsave(p1,filename = "plots/coalition_responses.png",width=20,height=12,units="cm",dpi=300)

  
```


```{r}

p2 <- responses_pilot2 %>% 
  filter(coalition_party_vote_intention=="Anti Netanyahu coalition") %>%
  ggplot(aes(x=populist_attitudes_index_4dim,y=response_direction))+
  geom_text(aes(label = response,color=morality |> as_factor()),size=1.5,position = position_jitter())+
  geom_smooth(method="lm")+
  labs(title="Only Anti coalition party voters")+
  theme_classic()

p2 

ggsave(p2,filename = "plots/Anti coalition_responses.png",width=20,height=12,units="cm",dpi=300)

  
```

```{r}
pilot2 %>% count(civil_servant_label)
```



# Stereotype scales



q55_1_caring          – אכפתיים מאוד — לא אכפתיים בכלל
q55_2_cold_warm       – חמים מאוד ביחסם לאנשים — קרים מאוד ביחסם לאנשים
q55_3_empathetic      – אמפתיים מאוד — לא אמפתיים בכלל
q55_4_affectionate    – לבביים מאוד — לא לבביים
q55_5_friendly        – ידידותיים מאוד — לא ידידותיים בכלל
q55_6_just            – מאוד מוסריים — לא מוסריים כלל
q55_7_fair            – הוגנים מאוד — לא הוגנים כלל
q55_8_considerate     – מאוד מתחשבים — בכלל לא מתחשבים
q55_9_trustworthy     – אמינים מאוד — כלל לא אמינים
q55_10_reliable       – אחראים מאוד — חסרי אחריות
q55_11_self_confident – בעלי ביטחון עצמי גבוה מאוד — חסרי ביטחון עצמי
q55_12_under_pressure – מתמודדים היטב עם מצבי לחץ — קורסים תחת לחץ
q55_13_give_up        – לא מוותרים בקלות — מוותרים בקלות
q55_14_leadership     – בעלי כושר מנהיגות — חסרי כושר מנהיגות
q55_15_superiority    – חשים עליונות ביחס לאחרים — חשים נחותים ביחס לאחרים
q55_16_efficient      – מאוד יעילים — אינם יעילים
q55_17_capable        – בעלי מסוגלות גבוהה — חסרי מסוגלות
q55_18_competent      – מיומנים מאוד — חסרי מיומנות
q55_19_intelligent    – מאוד אינטליגנטים — לא אינטליגנטים בכלל
q55_20_clever         – מאוד פיקחים — לא פיקחים




```{r}
# summary statistics for items q55...

pilot2 %>% remove_labels() %>%
  dplyr::select(starts_with("q55"),civil_servant_label) %>%
  gtsummary::tbl_summary(
    statistic = list(all_continuous() ~ "{mean} ({sd})"),
    digits = all_continuous() ~ 2,
    by = civil_servant_label
  )
```

```{r}

# Convert to long format
survey_long <- pilot2 |> 
  select(starts_with("q55_"),civil_servant_label) |>
  pivot_longer(
    cols = starts_with("q55_"),
    names_to = "item",
    values_to = "response"
  )


# Bar plot (showing percentage distribution)
ggplot(survey_long, aes(x = response, fill = response)) +
  geom_bar(color = "white") +
  facet_wrap(~ item, ncol = 4) +
  scale_y_continuous() +
  scale_fill_brewer(palette = "Blues") +
  theme_minimal(base_size = 12) +
  labs(
    title = "Distribution of Stereotype Items",
    x = "Response",
    y = "Frequency"
  ) +
  theme(
    legend.position = "none",
    strip.text = element_text(face = "bold", size = 9)
  )

```

```{r}
# Prepare data in long format
survey_long <- pilot2 |> drop_na(civil_servant_label) |>
  select(civil_servant_label, starts_with("q55_")) |>
  pivot_longer(
    cols = starts_with("q55_"),
    names_to = "item",
    values_to = "response"
  )

# Ensure response is numeric
survey_long <- survey_long |>
  mutate(response = as.numeric(response))

# Violin plot
ggplot(survey_long, aes(x = civil_servant_label, y = response, fill = civil_servant_label)) +
  geom_violin(trim = FALSE, alpha = 0.7) +
  geom_boxplot(width = 0.15, color = "black", fill = "white", outlier.shape = NA) +
  facet_wrap(~ item, ncol = 4, scales = "free_y") +
  scale_fill_brewer(palette = "Set2", name = "Civil Servant Group") +
  theme_minimal(base_size = 12) +
  labs(
    title = "Distribution of Stereotype Items Across Civil Servant Groups",
    x = "Civil Servant Label",
    y = "Response"
  ) +
  theme(
    legend.position = "none",
    strip.text = element_text(face = "bold", size = 9),
    axis.text.x = element_text(angle = 30, hjust = 1)
  )

```

```{r}
pilot2 %>% remove_labels() %>%
  dplyr::select(starts_with("q55")) %>%
  sjmisc::descr(out = "viewer")
```


```{r}
pilot2 %>% remove_labels() %>%
  dplyr::select(starts_with("q55")) %>%
  sjPlot::tab_corr(triangle = "lower", show.p = F)
```


Sociability

**q55_1_caring          – אכפתיים מאוד — לא אכפתיים בכלל**
q55_2_cold_warm       – חמים מאוד ביחסם לאנשים — קרים מאוד ביחסם לאנשים
q55_3_empathetic      – אמפתיים מאוד — לא אמפתיים בכלל
q55_4_affectionate    – לבביים מאוד — לא לבביים
**q55_5_friendly        – ידידותיים מאוד — לא ידידותיים בכלל**

```{r}

# Convert to long format
survey_long <- pilot2 |> 
    dplyr::select(q55_1_caring:q55_5_friendly,civil_servant_label) %>% 
  pivot_longer(
    cols = starts_with("q55_"),
    names_to = "item",
    values_to = "response"
  )


# Bar plot (showing percentage distribution)
ggplot(survey_long, aes(x = response, fill = response)) +
  geom_bar(color = "white") +
  facet_wrap(~ item, ncol = 4) +
  scale_y_continuous() +
  scale_fill_brewer(palette = "Blues") +
  theme_minimal(base_size = 12) +
  labs(
    title = "Distribution of Stereotype Items",
    x = "Response",
    y = "Frequency"
  ) +
  theme(
    legend.position = "none",
    strip.text = element_text(face = "bold", size = 9)
  )

```

```{r}
pilot2 %>% remove_labels() %>%
  dplyr::select(q55_1_caring:q55_5_friendly) %>% 
  sjPlot::tab_itemscale()
```

```{r}
pilot2 %>% remove_labels() %>%
  dplyr::select(q55_1_caring:q55_5_friendly) %>% 
  sjPlot::tab_corr(triangle = "lower", show.p = F)
```

```{r}
pilot2 %>%
  mutate(
    sociability = (q55_1_caring+q55_5_friendly-2)/8)  |> 
      ggplot(aes(x=sociability))+
  geom_bar()+
  #facet_wrap(vars(civil_servant_label))+
  theme_blank()


pilot2 %>%
  mutate(
    sociability = (q55_1_caring+q55_5_friendly-2)/8)  |> 
ggplot(aes(x=sociability))+
  geom_bar()+
  facet_wrap(vars(civil_servant_label))+
  theme_blank()


```


Morality

**q55_6_just            – מאוד מוסריים — לא מוסריים כלל**
**q55_7_fair            – הוגנים מאוד — לא הוגנים כלל**
q55_8_considerate     – מאוד מתחשבים — בכלל לא מתחשבים
**q55_9_trustworthy     – אמינים מאוד — כלל לא אמינים**
q55_10_reliable       – אחראים מאוד — חסרי אחריות


```{r}

# Convert to long format
survey_long <- pilot2 |> 
    dplyr::select(q55_6_just:q55_10_reliable,civil_servant_label) %>% 
  pivot_longer(
    cols = starts_with("q55_"),
    names_to = "item",
    values_to = "response"
  )


# Bar plot (showing percentage distribution)
ggplot(survey_long, aes(x = response, fill = response)) +
  geom_bar(color = "white") +
  facet_wrap(~ item, ncol = 4) +
  scale_y_continuous() +
  scale_fill_brewer(palette = "Blues") +
  theme_minimal(base_size = 12) +
  labs(
    title = "Distribution of Stereotype Items",
    x = "Response",
    y = "Frequency"
  ) +
  theme(
    legend.position = "none",
    strip.text = element_text(face = "bold", size = 9)
  )

```

```{r}
pilot2 %>% remove_labels() %>%
    dplyr::select(q55_6_just:q55_10_reliable) %>% 
  sjPlot::tab_itemscale()
```

```{r}
pilot2 %>% remove_labels() %>%
    dplyr::select(q55_6_just:q55_10_reliable) %>% 
  sjPlot::tab_corr(triangle = "lower", show.p = F)
```

```{r}
pilot2 %>% remove_labels() %>%
    dplyr::select(q55_6_just,q55_7_fair,q55_9_trustworthy) %>% 
  sjPlot::tab_itemscale()
```

```{r}
pilot2 %>%
  mutate(
    morality = (q55_6_just+q55_7_fair+q55_9_trustworthy-3)/12)  |> 
      ggplot(aes(x=morality))+
  geom_bar()+
  #facet_wrap(vars(civil_servant_label))+
  theme_blank()


pilot2 %>%
  mutate(
    morality = (q55_1_caring+q55_5_friendly-2)/8)  |> 
ggplot(aes(x=morality))+
  geom_bar()+
  facet_wrap(vars(civil_servant_label))+
  theme_blank()

```


```{r}
#correlation bewteen sociability and morality scales

pilot2 %>%
  mutate(
    sociability = (q55_1_caring+q55_5_friendly-2)/8,
    morality = (q55_6_just+q55_7_fair+q55_9_trustworthy-3)/12
  )  |> 
  ggplot(aes(x=sociability,y=morality))+
  geom_jitter(alpha=0.5)+
  geom_smooth(method="lm")+ # add r-squared 
  theme_blank() +
  ggpubr::stat_cor(method = "pearson")


pilot2 %>%
  mutate(
    sociability = (q55_1_caring+q55_5_friendly-2)/8,
    morality = (q55_6_just+q55_7_fair+q55_9_trustworthy-3)/12
  )  |> 
  ggplot(aes(x=sociability,y=morality))+
  geom_jitter(alpha=0.5)+
  geom_smooth(method="lm")+ # add r-squared 
  theme_blank() +
  facet_wrap(vars(civil_servant_label))+
  ggpubr::stat_cor(method = "pearson")

```

Ability
**q55_16_efficient      – מאוד יעילים — אינם יעילים**
q55_17_capable        – בעלי מסוגלות גבוהה — חסרי מסוגלות
**q55_18_competent      – מיומנים מאוד — חסרי מיומנות**
**q55_19_intelligent    – מאוד אינטליגנטים — לא אינטליגנטים בכלל**
q55_20_clever         – מאוד פיקחים — לא פיקחים


```{r}

# Convert to long format
survey_long <- pilot2 |> 
    dplyr::select(q55_16_efficient:q55_20_clever,civil_servant_label) %>% 
  pivot_longer(
    cols = starts_with("q55_"),
    names_to = "item",
    values_to = "response"
  )


# Bar plot (showing percentage distribution)
ggplot(survey_long, aes(x = response, fill = response)) +
  geom_bar(color = "white") +
  facet_wrap(~ item, ncol = 4) +
  scale_y_continuous() +
  scale_fill_brewer(palette = "Blues") +
  theme_minimal(base_size = 12) +
  labs(
    title = "Distribution of Stereotype Items",
    x = "Response",
    y = "Frequency"
  ) +
  theme(
    legend.position = "none",
    strip.text = element_text(face = "bold", size = 9)
  )

```

```{r}
pilot2 %>% remove_labels() %>%
    dplyr::select(q55_16_efficient:q55_20_clever) %>% 
  sjPlot::tab_itemscale()
```

```{r}
pilot2 %>% remove_labels() %>%
    dplyr::select(q55_16_efficient:q55_20_clever) %>% 
  sjPlot::tab_corr(triangle = "lower", show.p = F)
```

```{r}
pilot2 %>% remove_labels() %>%
    dplyr::select(q55_16_efficient,q55_18_competent,q55_19_intelligent) %>% 
  sjPlot::tab_itemscale()
```

```{r}
pilot2 %>%
  mutate(
    ability = (q55_16_efficient+q55_18_competent+q55_19_intelligent-3)/12)  |> 
      ggplot(aes(x=ability))+
  geom_bar()+
  #facet_wrap(vars(civil_servant_label))+
  theme_blank()


pilot2 %>%
  mutate(
    ability = (q55_16_efficient+q55_18_competent+q55_19_intelligent-3)/12)  |> 
      ggplot(aes(x=ability))+
  geom_bar()+
  facet_wrap(vars(civil_servant_label))+
  theme_blank()

```


```{r}
#correlation bewteen sociability and morality scales

pilot2 %>%
  mutate(
    sociability = (q55_1_caring+q55_5_friendly-2)/8,
    morality = (q55_6_just+q55_7_fair+q55_9_trustworthy-3)/12,
    ability = (q55_16_efficient+q55_18_competent+q55_19_intelligent-3)/12 
  )  |> 
  ggplot(aes(x=ability,y=morality))+
  geom_jitter(alpha=0.5)+
  geom_smooth(method="lm")+ # add r-squared 
  theme_blank() +
  ggpubr::stat_cor(method = "pearson")



pilot2 %>%
  mutate(
    sociability = (q55_1_caring+q55_5_friendly-2)/8,
    morality = (q55_6_just+q55_7_fair+q55_9_trustworthy-3)/12,
    ability = (q55_16_efficient+q55_18_competent+q55_19_intelligent-3)/12 
  )  |> 
  ggplot(aes(x=ability,y=morality))+
  geom_jitter(alpha=0.5)+
  geom_smooth(method="lm")+ # add r-squared 
  theme_blank() +
  facet_wrap(vars(civil_servant_label))+
  ggpubr::stat_cor(method = "pearson")

```


Assertiveness
**q55_11_self_confident – בעלי ביטחון עצמי גבוה מאוד — חסרי ביטחון עצמי**
**q55_12_under_pressure – מתמודדים היטב עם מצבי לחץ — קורסים תחת לחץ**
**q55_13_give_up        – לא מוותרים בקלות — מוותרים בקלות**
q55_14_leadership     – בעלי כושר מנהיגות — חסרי כושר מנהיגות
q55_15_superiority    – חשים עליונות ביחס לאחרים — חשים נחותים ביחס לאחרים


```{r}

# Convert to long format
survey_long <- pilot2 |> 
    dplyr::select(q55_11_self_confident:q55_15_superiority,civil_servant_label) %>% 
  pivot_longer(
    cols = starts_with("q55_"),
    names_to = "item",
    values_to = "response"
  )


# Bar plot (showing percentage distribution)
ggplot(survey_long, aes(x = response, fill = response)) +
  geom_bar(color = "white") +
  facet_wrap(~ item, ncol = 4) +
  scale_y_continuous() +
  scale_fill_brewer(palette = "Blues") +
  theme_minimal(base_size = 12) +
  labs(
    title = "Distribution of Stereotype Items",
    x = "Response",
    y = "Frequency"
  ) +
  theme(
    legend.position = "none",
    strip.text = element_text(face = "bold", size = 9)
  )

```

```{r}
pilot2 %>% remove_labels() %>%
    dplyr::select(q55_11_self_confident:q55_15_superiority) %>% 
  sjPlot::tab_itemscale()
```

```{r}
pilot2 %>% remove_labels() %>%
    dplyr::select(q55_11_self_confident:q55_15_superiority) %>% 
  sjPlot::tab_corr(triangle = "lower", show.p = F)
```

```{r}

pilot2 %>% remove_labels() %>%
  filter(civil_servant_label=="public service employee") %>%
    dplyr::select(q55_11_self_confident:q55_13_give_up) %>% 
  sjPlot::tab_itemscale()
```

```{r}
pilot2 %>%
  mutate(
    assertiveness = (q55_11_self_confident+q55_12_pressure_coping+q55_13_give_up-3)/12)  |> 
      ggplot(aes(x=assertiveness))+
  geom_bar()+
  #facet_wrap(vars(civil_servant_label))+
  theme_blank()


pilot2 %>%
  mutate(
    assertiveness = (q55_11_self_confident+q55_12_pressure_coping+q55_13_give_up-3)/12)  |> 
      ggplot(aes(x=assertiveness))+
  geom_bar()+
  facet_wrap(vars(civil_servant_label))+
  theme_blank()

```


```{r}
#correlation bewteen sociability and morality scales

pilot2 %>%
  mutate(
    sociability = (q55_1_caring+q55_5_friendly-2)/8,
    morality = (q55_6_just+q55_7_fair+q55_9_trustworthy-3)/12,
    ability = (q55_16_efficient+q55_18_competent+q55_19_intelligent-3)/12 ,
    assertiveness = (q55_11_self_confident+q55_12_pressure_coping+q55_13_give_up-3)/12
  )  |> 
  ggplot(aes(x=ability,y=assertiveness))+
  geom_jitter(alpha=0.5)+
  geom_smooth(method="lm")+ # add r-squared 
  theme_blank() +
  ggpubr::stat_cor(method = "pearson")



pilot2 %>%
  mutate(
    sociability = (q55_1_caring+q55_5_friendly-2)/8,
    morality = (q55_6_just+q55_7_fair+q55_9_trustworthy-3)/12,
    ability = (q55_16_efficient+q55_18_competent+q55_19_intelligent-3)/12 ,
    assertiveness = (q55_11_self_confident+q55_12_pressure_coping+q55_13_give_up-3)/12
  )  |> 
  ggplot(aes(x=ability,y=assertiveness))+
  geom_jitter(alpha=0.5)+
  geom_smooth(method="lm")+ # add r-squared 
  theme_blank() +
  ggpubr::stat_cor(method = "pearson")+
  facet_wrap(vars(civil_servant_label))

```



### 1 factor (aftrer reducing items)

```{r}
cfa.model.1factor_ster <- '
  one_factor =~ q55_1_caring+q55_5_friendly+q55_6_just+q55_7_fair+q55_9_trustworthy+q55_16_efficient+q55_18_competent+q55_19_intelligent+q55_11_self_confident+q55_12_pressure_coping+q55_13_give_up'

fit.cfa.model.1factor_ster <- cfa(
  cfa.model.1factor_ster, # model formula,
  data = pilot2,
  se = "robust",
  std.lv = T
)

summary(fit.cfa.model.1factor_ster, fit.measures = TRUE, standardize = TRUE)
```



### 4 factor (all items)

```{r}
  

cfa.model.4factor_ster <- '
  sociability =~ q55_1_caring + q55_2_cold_warm + q55_3_empathetic + q55_4_affectionate + q55_5_friendly
  morality =~  q55_6_just + q55_7_fair + q55_8_considerate + q55_9_trustworthy + q55_10_reliable           
  assertiveness =~   q55_11_self_confident + q55_12_under_pressure + q55_13_give_up + q55_14_leadership + q55_15_superiority
  ability =~ q55_16_efficient  + q55_17_capable + q55_18_competent + q55_19_intelligent + q55_20_clever'



fit.cfa.model.4factor_ster <- cfa(
  cfa.model.4factor_ster, # model formula,
  data = pilot2,
  se = "robust",
  std.lv = T
)

summary(fit.cfa.model.4factor_ster, fit.measures = TRUE, standardize = TRUE)
```


### 4 factor 

```{r}

cfa.model.4factor_ster <- '
  sociability =~ q55_1_caring+q55_5_friendly
  morality =~  q55_6_just+q55_7_fair+q55_9_trustworthy     
  assertiveness =~   q55_11_self_confident+q55_12_pressure_coping+q55_13_give_up
  ability =~ q55_16_efficient+q55_18_competent+q55_19_intelligent'



fit.cfa.model.4factor_ster <- cfa(
  cfa.model.4factor_ster, # model formula,
  data = pilot2,
  se = "robust",
  std.lv = T
)

summary(fit.cfa.model.4factor_ster, fit.measures = TRUE, standardize = TRUE)
```


```{r}
parameterEstimates(fit.cfa.model.4factor_ster, standardized=TRUE) %>% 
  filter(op == "=~") %>% 
  mutate(Beta = str_c(std.all %>% round(3)," (",pvalue %>% round(3),")")) %>% 
    dplyr::select('Latent Factor'=lhs,  
           'Indicator' = rhs,
           'Estimate std.' = Beta) %>% 
gt()

```

```{r}
fitmeasures(fit.cfa.model.4factor_ster, c('chisq','df','pvalue','cfi','tli', 'rmsea', 'rmsea.ci.upper','rmsea.ci.lower', 'srmr')) %>% 
  broom::tidy() %>% 
  pivot_wider(names_from = names,values_from = x) %>% 
  mutate(chisq_01 = str_c(chisq %>% round(3)," [","df=",df,", p=",pvalue %>% round(3),"]"),
         rmsea_01 = str_c(rmsea %>% round(3)," CI[", rmsea.ci.lower %>% round(3),",",rmsea.ci.upper %>% round(3),"]"),
         cfi = cfi %>% round(3),
         tli = tli %>% round(3),
         srmr = srmr %>% round(3),
         n = fit.cfa.model.4factor_ster@SampleStats@nobs) %>%
  dplyr::select('N' = n,
          'Chi-sq' = chisq_01,
         'CFI' = cfi,
         'TLI' = tli,
         'RMSEA' = rmsea_01,
         'SRMR' = srmr) %>% 
  t() 
```


### 2 factor

```{r}

cfa.model.2factor_ster <- '
  communion =~ q55_1_caring+q55_5_friendly + q55_6_just+q55_7_fair+q55_9_trustworthy     
  agency =~   q55_11_self_confident+q55_12_pressure_coping+q55_13_give_up + q55_16_efficient+q55_18_competent+q55_19_intelligent'



fit.cfa.model.2factor_ster <- cfa(
  cfa.model.2factor_ster, # model formula,
  data = pilot2,
  se = "robust",
  std.lv = T
)

summary(fit.cfa.model.2factor_ster, fit.measures = TRUE, standardize = TRUE)
```


```{r}
pilot2 <- pilot2 %>%
  mutate(
    sociability_scale = (q55_1_caring+q55_5_friendly-2)/8,
    morality_scale = (q55_6_just+q55_7_fair+q55_9_trustworthy-3)/12,
    ability_scale = (q55_16_efficient+q55_18_competent+q55_19_intelligent-3)/12 ,
    assertiveness_scale = (q55_11_self_confident+q55_12_pressure_coping+q55_13_give_up-3)/12
  )



  responses_pilot2 <- responses_pilot2 %>%
  mutate(
    sociability_scale = (q55_1_caring+q55_5_friendly-2)/8,
    morality_scale = (q55_6_just+q55_7_fair+q55_9_trustworthy-3)/12,
    ability_scale = (q55_16_efficient+q55_18_competent+q55_19_intelligent-3)/12 ,
    assertiveness_scale = (q55_11_self_confident+q55_12_pressure_coping+q55_13_give_up-3)/12
  )

```

## Correlations with trust and conspiracy

```{r}
pilot2 %>% remove_labels() %>%
  dplyr::select(sociability_scale,
                morality_scale,
                ability_scale,
                assertiveness_scale,
                conspiracy_deep_state_n,
    conspiracy_vaccine_n,
    trust_knesset:trust_media) %>%
  sjPlot::tab_corr(triangle = "lower", show.p = F)
```


```{r}
pilot2 %>% remove_labels() %>%
  filter(coalition_party_vote_intention=="Netanyahu coalition") %>%
  dplyr::select(sociability_scale,
                morality_scale,
                ability_scale,
                assertiveness_scale,
                conspiracy_deep_state_n,
    conspiracy_vaccine_n,
    trust_knesset:trust_media) %>%
  sjPlot::tab_corr(triangle = "lower", show.p = F)
```

```{r}
pilot2 %>% remove_labels() %>%
  filter(coalition_party_vote_intention=="Anti Netanyahu coalition") %>%
  dplyr::select(sociability_scale,
                morality_scale,
                ability_scale,
                assertiveness_scale,
                conspiracy_deep_state_n,
    conspiracy_vaccine_n,
    trust_knesset:trust_media) %>%
  sjPlot::tab_corr(triangle = "lower", show.p = F)
```


## Correlations with responses


```{r}
responses_pilot2 %>% remove_labels() %>%
  dplyr::select(sociability_scale,
                morality_scale,
                ability_scale,
                assertiveness_scale,
                response_direction) %>%
  sjPlot::tab_corr(triangle = "lower", show.p = F)
```


```{r}
responses_pilot2 %>% remove_labels() %>%
  filter(sociability==1) |> 
  dplyr::select(sociability_scale,
                morality_scale,
                ability_scale,
                assertiveness_scale,
                response_direction) %>%
  sjPlot::tab_corr(triangle = "lower", show.p = F,title="sociability = 1")

```

```{r}
responses_pilot2 %>% remove_labels() %>%
  filter(morality==1) |> 
  dplyr::select(sociability_scale,
                morality_scale,
                ability_scale,
                assertiveness_scale,
                response_direction) %>%
  sjPlot::tab_corr(triangle = "lower", show.p = F,title="Morality = 1")

```


```{r}
responses_pilot2 %>% remove_labels() %>%
  filter(ability==1) |> 
  dplyr::select(sociability_scale,
                morality_scale,
                ability_scale,
                assertiveness_scale,
                response_direction) %>%
  sjPlot::tab_corr(triangle = "lower", show.p = F,title="Ability = 1")

```

```{r}
responses_pilot2 %>% remove_labels() %>%
  filter(assertiveness==1) |> 
  dplyr::select(sociability_scale,
                morality_scale,
                ability_scale,
                assertiveness_scale,
                response_direction) %>%
  sjPlot::tab_corr(triangle = "lower", show.p = F,title="assertiveness = 1")

```

### correlation with populist attitudes index

```{r}

```
```{r}
pilot2 %>% 
  drop_na(civil_servant_label) %>%
#filter(civil_servant_label!="public service bureaucrat") %>% 
  ggplot(aes(x=populist_attitudes_index_4dim,y=morality_scale,color=coalition_party_vote_intention))+
  geom_jitter(alpha=0.6)+
  facet_wrap(vars(civil_servant_label))+
  geom_smooth(method="lm")+
  theme_blank()
  
```

